(this["webpackJsonpclient-app"]=this["webpackJsonpclient-app"]||[]).push([[0],{224:function(e,t,n){},259:function(e,t,n){"use strict";n.r(t),n.d(t,"history",(function(){return sn}));var r=n(1),i=n(0),o=n.n(i),c=n(86),a=n.n(c),s=n(42),u=n(31),l=(n(224),n(9)),d=n(285),p=n(276),j=n(295),b=n(171),h=n(5),f=n.n(h),m=n(10),g=n(37),x=n(71),O=n(50),v=n.n(O);v.a.defaults.baseURL="/api",v.a.interceptors.request.use((function(e){var t=window.localStorage.getItem("jwt");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(function(e){return Promise.reject(e)})),v.a.interceptors.response.use(function(){var e=Object(m.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=3;break;case 3:return e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){var t;console.log("error: ",e.response);var n=e.response,r=n.status,i=n.data,o=n.config,c=n.headers;if("Network Error"!==e.message||e.response||sn.push("/NoNet"),400===r){if("string"===typeof i)return Promise.reject(e.response);if("get"===o.method&&i.errors.hasOwnProperty("id")&&sn.push("/notfound"),i.errors){var a=[];for(var s in i.errors)i.errors[s]&&a.push(i.errors[s]);throw a.flat()}}return 401===r&&(null===(t=c["www-authenticate"])||void 0===t?void 0:t.includes("The token expired"))&&(window.localStorage.removeItem("jwt"),sn.push("/"),console.log("Your session has expired, please login again")),401===r&&sn.push("/"),404===r&&"/user/login"===o.url||400===r&&"/user/login"===o.url||(404===r&&sn.push("/notfound"),500===r&&(L.commonStore.setServerError(i),sn.push("/server-error"))),Promise.reject(e.response)}));var k=function(e){return e.data},y={get:function(e){return v.a.get(e).then(k)},post:function(e,t){return v.a.post(e,t).then(k)},put:function(e,t){return v.a.put(e,t).then(k)},del:function(e){return v.a.delete(e).then(k)},postForm:function(){var e=Object(m.a)(f.a.mark((function e(t,n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new FormData,n.blob?r.append("File",n.blob,n.name):r.append("File",n),e.abrupt("return",v.a.post(t,r,{headers:{"Content-Type":"multipart/form-data"}}).then(k));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),postTicketForm:function(){var e=Object(m.a)(f.a.mark((function e(t,n,r){var i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o in i=new FormData,n)i.append(o,n[o]);return i.append("File",r.blob,r.name),e.abrupt("return",v.a.post(t,i,{headers:{"Content-Type":"multipart/form-data"}}).then(k));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),postTicketForms:function(){var e=Object(m.a)(f.a.mark((function e(t,n,r){var i,o,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o in i=new FormData,n)i.append(o,n[o]);for(c=0;c<r.length;c++)i.append("File",r[c].blob,r[c].name);return e.abrupt("return",v.a.post(t,i,{headers:{"Content-Type":"multipart/form-data"}}).then(k));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),postTextForm:function(){var e=Object(m.a)(f.a.mark((function e(t,n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new FormData).append("File",n),e.abrupt("return",v.a.post(t,r,{headers:{"Content-Type":'text/plain; charset="utf-8"'}}).then(k));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},w={Tickets:{list:function(){return y.get("/tickets")},details:function(e){return y.get("/tickets/".concat(e))},create:function(e){return y.post("/tickets",e)},createWithPhoto:function(e,t){return y.postTicketForm("/tickets/withPhoto",e,t)},createTicketMultiple:function(e,t){return y.postTicketForms("/tickets/withPhoto",e,t)},update:function(e){return y.put("/tickets/".concat(e.id),e)},delete:function(e){return y.del("/tickets/".concat(e))},addComment:function(e,t){return y.post("/tickets/comment/".concat(e),t)},delComment:function(e,t){return y.del("/tickets/comment/".concat(e,"/").concat(t))},editComment:function(e,t,n){return y.put("/tickets/comment/".concat(e,"/").concat(t),n)},addPhoto:function(e,t){return y.postForm("/photos/tickets/".concat(e),t)},delPhoto:function(e,t){return y.del("/photos/tickets/".concat(e,"/").concat(t))},addTextFile:function(e,t){return y.postTextForm("/texts/tickets/".concat(e),t)},delTextFile:function(e,t){return y.del("/texts/tickets/".concat(e,"/").concat(t))}},Groups:{list:function(){return y.get("/groups")},details:function(e){return y.get("/groups/".concat(e))},create:function(e){return y.post("/groups",e)},update:function(e){return y.put("/groups/".concat(e.id),e)},delete:function(e){return y.del("/groups/".concat(e))},join:function(e){return y.post("/groups/".concat(e,"/join"),{})},leave:function(e){return y.del("/groups/".concat(e,"/join"))},editMember:function(e,t){return y.put("/groups/".concat(e,"/member"),t)},addAnnouncement:function(e,t){return y.post("/groups/announcement/".concat(e),t)},delAnnouncement:function(e,t){return y.del("/groups/announcement/".concat(e,"/").concat(t))},uploadPhoto:function(e,t){return y.postForm("/photos/groups/".concat(e),t)},deletePhoto:function(e,t){return y.del("/photos/groups/".concat(e,"/").concat(t))}},User:{current:function(){return y.get("/user")},login:function(e){return y.post("/user/login",e)},delete:function(e){return y.del("/user/delete/".concat(e))},register:function(e){return y.post("/user/register",e)},refreshToken:function(){return y.post("/user/refreshToken",{})}},Profiles:{get:function(e){return y.get("profiles/".concat(e))},uploadPhoto:function(e){return y.postForm("/photos",e)},setMainPhoto:function(e){return y.post("/photos/".concat(e,"/setMain"),{})},deletePhoto:function(e){return y.del("/photos/".concat(e))},editProfile:function(e){return y.put("/profiles",e)}}},C=function(){function e(){var t=this;Object(g.a)(this,e),this.tickets=[],this.selectedTicket=null,this.ticketFiles=[],this.ticketRegistry=new Map,this.loadingTickets=!1,this.submittingTicket=!1,this.isAddingComment=!1,this.isEditingComment=!1,this.isDeletingComment=!1,this.isAddingPhoto=!1,this.isDeletingPhoto=!1,this.isAddingText=!1,this.isDeletingText=!1,this.ticketListStats={open:0,closed:0,verify:0},this.isTicketCreatorOrAdmin=function(){var e,n,r,i;Object(l.h)(Object(m.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==L.groupStore.groupRegistry.size){e.next=3;break}return e.next=3,L.groupStore.loadGroups();case 3:case"end":return e.stop()}}),e)}))));var o=L.groupStore.isHostOrAdminOfGroup||(null===(e=L.groupStore.groupRegistry.get(null===(n=t.selectedTicket)||void 0===n?void 0:n.groupId))||void 0===e?void 0:e.members.filter((function(e){var t;return e.isHost&&e.username===(null===(t=L.userStore.user)||void 0===t?void 0:t.username)})).length)>0,c=(null===(r=t.selectedTicket)||void 0===r?void 0:r.creator)===(null===(i=L.userStore.user)||void 0===i?void 0:i.username);return o||c},this.setSelectedTicket=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{Object(l.h)((function(){n&&(t.selectedTicket=n)}))}catch(r){console.log(r)}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.setSelectedTicketFromId=function(){var e=Object(m.a)(f.a.mark((function e(n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.ticketRegistry.get(n)){e.next=4;break}return e.next=4,t.loadTickets();case 4:return e.next=6,t.ticketRegistry.get(n);case 6:r=e.sent,Object(l.h)((function(){t.selectedTicket=r})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),this.loadTickets=Object(m.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingTickets=!0,e.prev=1,e.next=4,w.Tickets.list();case 4:n=e.sent,Object(l.h)((function(){t.ticketListStats.open=0,t.ticketListStats.closed=0,t.ticketListStats.verify=0,n.forEach((function(e){e.date=e.date.split(".")[0];var n=e.status.toLowerCase(),r=t.ticketListStats[n]+=1;t.ticketListStats[n]=r,t.ticketRegistry.set(e.id,e)})),t.loadingTickets=!1})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(l.h)((function(){console.log("Error loadTickets in MobX store ticketStore, ",e.t0),t.loadingTickets=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),this.createTicket=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.submittingTicket=!0,e.prev=1,e.next=4,w.Tickets.create(n);case 4:Object(l.h)((function(){t.ticketRegistry.set(n.id,n),t.selectedTicket=n,t.submittingTicket=!1})),sn.push("/issues"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(l.h)((function(){t.submittingTicket=!1,console.log("Error createTicket, ",e.t0)}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.fileToBlob=function(){var e=Object(m.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Blob,e.t1=Uint8Array,e.next=4,t.arrayBuffer();case 4:return e.t2=e.sent,e.t3=new e.t1(e.t2),e.t4=[e.t3],e.t5={type:t.type},e.abrupt("return",new e.t0(e.t4,e.t5));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.setTicketFiles=function(){var e=Object(m.a)(f.a.mark((function e(n){var r,i,o,c,a,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length>0)){e.next=22;break}r=[],i=0;case 3:if(!(i<n.length)){e.next=19;break}if(!n[i]||!["image/png","image/jpg","image/jpeg"].includes(n[i].type)){e.next=10;break}return e.next=7,t.fileToBlob(n[i]);case 7:o=e.sent,c={blob:o,name:n[i].name},r.push(c);case 10:if(!n[i]||"text/plain"!==n[i].type){e.next=16;break}return e.next=13,t.fileToBlob(n[i]);case 13:a=e.sent,s={blob:a,name:n[i].name},r.push(s);case 16:i++,e.next=3;break;case 19:Object(l.h)((function(){t.ticketFiles.length>0?r.forEach((function(e){t.ticketFiles.push(e)})):t.ticketFiles=r})),e.next=23;break;case 22:Object(l.h)((function(){t.ticketFiles=[]}));case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.createWithPhoto=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.submittingTicket=!0,e.prev=1,e.next=4,w.Tickets.createTicketMultiple(n,t.ticketFiles);case 4:Object(l.h)((function(){t.ticketRegistry.set(n.id,n),t.selectedTicket=n,t.submittingTicket=!1})),sn.push("/issues"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(l.h)((function(){t.submittingTicket=!1,t.setTicketFiles([]),console.log("Error createTicket, ",e.t0)}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.editTicket=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.submittingTicket=!0,e.prev=1,e.next=4,w.Tickets.update(n);case 4:Object(l.h)((function(){var e=t.ticketRegistry.get(n.id).status.toLowerCase(),r=n.status.toLowerCase();r!==e?(t.ticketRegistry.set(n.id,n),t.ticketListStats[r]+=1,t.ticketListStats[e]-=1):t.ticketRegistry.set(n.id,n),t.selectedTicket=n,t.submittingTicket=!1})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),Object(l.h)((function(){t.submittingTicket=!1,console.log("Error editTicket, ",e.t0)}));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.editTicketStatus=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.submittingTicket=!0,e.prev=1,e.next=4,w.Tickets.update(n);case 4:Object(l.h)((function(){var e=t.selectedTicket.status.toLowerCase(),r=n.status.toLowerCase();r!==e&&(t.ticketListStats[r]+=1,t.ticketListStats[e]-=1),t.selectedTicket=n,t.submittingTicket=!1})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),Object(l.h)((function(){t.submittingTicket=!1,console.log("Error editTicketStatus, ",e.t0)}));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.addComment=function(){var e=Object(m.a)(f.a.mark((function e(n,r){var i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isAddingComment=!0,e.prev=1,e.next=4,w.Tickets.addComment(n.id,r);case 4:i=e.sent,Object(l.h)((function(){var e;null===(e=n.comments)||void 0===e||e.push(i),t.ticketRegistry.set(n.id,n),t.selectedTicket=n,t.isAddingComment=!1})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(l.h)((function(){console.log(e.t0),t.isAddingComment=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),this.deleteComment=function(){var e=Object(m.a)(f.a.mark((function e(n,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isDeletingComment=!0,e.prev=1,e.next=4,w.Tickets.delComment(n,r);case 4:Object(l.h)((function(){var e,i,o=null===(e=t.selectedTicket)||void 0===e||null===(i=e.comments)||void 0===i?void 0:i.filter((function(e){return e.id!==r})),c=t.selectedTicket;t.selectedTicket.comments=o,t.ticketRegistry.set(n,c),t.isDeletingComment=!1})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),Object(l.h)((function(){console.log(e.t0),t.isDeletingComment=!1}));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}(),this.editComment=function(){var e=Object(m.a)(f.a.mark((function e(n,r,i){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isEditingComment=!0,e.prev=1,t.ticketRegistry.has(n)){e.next=5;break}return e.next=5,t.loadTickets();case 5:return e.next=7,w.Tickets.editComment(n,r,i);case 7:Object(l.h)((function(){var e=t.ticketRegistry.get(n),o=Object(l.i)(e);o.comments.forEach((function(e){e.id===r&&(e.body=i.body)})),t.ticketRegistry.set(o.id,o),t.selectedTicket=o,t.isEditingComment=!1})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),Object(l.h)((function(){console.log(e.t0),t.isEditingComment=!1}));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n,r){return e.apply(this,arguments)}}(),this.addPhoto=function(){var e=Object(m.a)(f.a.mark((function e(n,r){var i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isAddingPhoto=!0,e.prev=1,e.next=4,w.Tickets.addPhoto(n,r);case 4:i=e.sent,Object(l.h)((function(){var e;null===(e=t.selectedTicket.photos)||void 0===e||e.push(i),t.isAddingPhoto=!1})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(l.h)((function(){console.log(e.t0),t.isAddingPhoto=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),this.deletePhoto=function(){var e=Object(m.a)(f.a.mark((function e(n,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isDeletingPhoto=!0,e.prev=1,e.next=4,w.Tickets.delPhoto(n,r);case 4:Object(l.h)((function(){var e,n,i=null===(e=t.selectedTicket)||void 0===e||null===(n=e.photos)||void 0===n?void 0:n.filter((function(e){return e.id!==r}));t.selectedTicket.photos=i,t.isDeletingPhoto=!1})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),Object(l.h)((function(){console.log(e.t0),t.isDeletingPhoto=!1}));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}(),this.addTextFile=function(){var e=Object(m.a)(f.a.mark((function e(n,r){var i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isAddingText=!0,e.prev=1,e.next=4,w.Tickets.addTextFile(n,r);case 4:i=e.sent,Object(l.h)((function(){var e;i&&(null===(e=t.selectedTicket.texts)||void 0===e||e.push(i)),t.isAddingText=!1})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(l.h)((function(){console.log(e.t0),t.isAddingText=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),this.deleteTextFile=function(){var e=Object(m.a)(f.a.mark((function e(n,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isDeletingText=!0,e.prev=1,e.next=4,w.Tickets.delTextFile(n,r);case 4:Object(l.h)((function(){var e,n,i=null===(e=t.selectedTicket)||void 0===e||null===(n=e.texts)||void 0===n?void 0:n.filter((function(e){return e.id!==r}));t.selectedTicket.texts=i,t.isDeletingText=!1})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),Object(l.h)((function(){console.log(e.t0),t.isDeletingText=!1}));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}(),Object(l.e)(this)}return Object(x.a)(e,[{key:"ticketsByDate",get:function(){return Array.from(this.ticketRegistry.values()).slice().sort((function(e,t){return Date.parse(e.date)-Date.parse(t.date)}))}},{key:"allTickets",get:function(){return Array.from(this.ticketRegistry.values())}}]),e}(),T=function(){function e(){var t=this;Object(g.a)(this,e),this.refreshTokenTimeout=void 0,this.user=null,this.isDeletingUser=!1,this.login=function(){var e=Object(m.a)(f.a.mark((function e(n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.User.login(n);case 3:r=e.sent,Object(l.h)((function(){t.user=r})),L.commonStore.setToken(r.token),t.startRefreshTokenTimer(r),sn.push("/groups"),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(0),console.log(e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),this.logout=function(){L.commonStore.setToken(null),t.user=null,sn.push("/")},this.getUser=Object(m.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,w.User.current();case 3:n=e.sent,Object(l.h)((function(){t.user=n})),L.commonStore.setToken(n.token),t.startRefreshTokenTimer(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),this.register=function(){var e=Object(m.a)(f.a.mark((function e(n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n.dateJoined=new Date,e.next=4,w.User.register(n);case 4:r=e.sent,Object(l.h)((function(){t.user=r})),L.commonStore.setToken(r.token),t.startRefreshTokenTimer(r),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),this.deleteAccount=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isDeletingUser=!0,e.prev=1,e.next=4,w.User.delete(n);case 4:Object(l.h)((function(){t.user=null,t.isDeletingUser=!1})),sn.push("/"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(l.h)((function(){console.log(e.t0),t.isDeletingUser=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.refreshToken=Object(m.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopRefreshTokenTimer(),e.prev=1,e.next=4,w.User.refreshToken();case 4:n=e.sent,Object(l.h)((function(){t.user=n})),L.commonStore.setToken(n.token),t.startRefreshTokenTimer(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[1,10]])}))),Object(l.e)(this)}return Object(x.a)(e,[{key:"startRefreshTokenTimer",value:function(e){var t=JSON.parse(atob(e.token.split(".")[1])),n=new Date(1e3*t.exp).getTime()-Date.now()-6e4;this.refreshTokenTimeout=setTimeout(this.refreshToken,n)}},{key:"stopRefreshTokenTimer",value:function(){clearTimeout(this.refreshTokenTimeout)}},{key:"isLoggedIn",get:function(){return!!this.user}}]),e}(),S=function(){function e(){var t=this;Object(g.a)(this,e),this.profile=null,this.loadingProfile=!0,this.uploadingPhoto=!1,this.loadingMainPhotoSet=!1,this.loadingProfileUpdate=!1,this.loadProfile=function(){var e=Object(m.a)(f.a.mark((function e(n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingProfile=!0,e.prev=1,e.next=4,w.Profiles.get(n);case 4:r=e.sent,Object(l.h)((function(){t.profile=r,t.loadingProfile=!1})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(l.h)((function(){t.loadingProfile=!1,console.log(e.t0)}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.editProfile=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingProfileUpdate=!0,e.prev=1,e.next=4,w.Profiles.editProfile(n);case 4:Object(l.h)((function(){t.profile.displayName=n.displayName,t.profile.bio=n.bio,L.userStore.user.displayName=n.displayName,t.loadingProfileUpdate=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(l.h)((function(){t.loadingProfileUpdate=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.uploadPhoto=function(){var e=Object(m.a)(f.a.mark((function e(n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.uploadingPhoto=!0,e.prev=1,e.next=4,w.Profiles.uploadPhoto(n);case 4:r=e.sent,Object(l.h)((function(){t.profile&&(t.profile.photos.push(r),r.isMain&&L.userStore.user&&(L.userStore.user.image=r.url,t.profile.image=r.url)),t.uploadingPhoto=!1})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),Object(l.h)((function(){t.uploadingPhoto=!1}));case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.setMainPhoto=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingMainPhotoSet=!0,e.prev=1,e.next=4,w.Profiles.setMainPhoto(n.id);case 4:Object(l.h)((function(){L.userStore.user.image=n.url,t.profile.photos.find((function(e){return e.isMain})).isMain=!1,t.profile.photos.find((function(e){return e.id===n.id})).isMain=!0,t.profile.image=n.url,t.loadingMainPhotoSet=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(l.h)((function(){t.loadingMainPhotoSet=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.deletePhoto=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingMainPhotoSet=!0,e.prev=1,e.next=4,w.Profiles.deletePhoto(n.id);case 4:Object(l.h)((function(){t.profile.photos=t.profile.photos.filter((function(e){return e.id!==n.id})),t.loadingMainPhotoSet=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(l.h)((function(){t.loadingMainPhotoSet=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),Object(l.e)(this)}return Object(x.a)(e,[{key:"isCurrentUser",get:function(){return!(!L.userStore.user||!this.profile)&&L.userStore.user.username===this.profile.username}}]),e}(),P=n(191),A=n(192),G=(n(243),n(170));var I,F,R,E=function(){var e=Object(m.a)(f.a.mark((function e(t){var n,r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=function(){var e=Object(m.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Blob,e.t1=Uint8Array,e.next=4,t.arrayBuffer();case 4:return e.t2=e.sent,e.t3=new e.t1(e.t2),e.t4=[e.t3],e.t5={type:t.type},e.abrupt("return",new e.t0(e.t4,e.t5));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),"text/plain"!==t[0].type){e.next=6;break}return r=t[0],e.abrupt("return",r);case 6:return e.next=8,n(t[0]);case 8:return i=e.sent,e.abrupt("return",{blob:i,name:t[0].name});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=(I=l.f.ref,F=function(){function e(){var t=this;Object(g.a)(this,e),this.groupRegistry=new Map,this.loadingGroups=!1,this.submittingAnnouncement=!1,this.submittingGroup=!1,this.selectedGroupId="",this.loadingGroupPhoto=!1,this.deletingGroupPhoto=!1,this.isPromotingMember=!1,this.isUploadingGroupEdit=!1,Object(P.a)(this,"hubConnection",R,this),this.createHubConnection=function(e){try{var n;if(t.selectedGroupId)t.hubConnection=(new G.a).withUrl("/chat?groupId="+e,{accessTokenFactory:function(){return L.commonStore.token}}).configureLogging(G.b.Information).build(),t.hubConnection.start().then((function(){return console.log(t.hubConnection.state)})).then((function(){"Connected"===t.hubConnection.state&&t.hubConnection.invoke("AddToGroup",e)})).catch((function(e){return console.log("Error establishing connection: ",e)})),null===(n=t.hubConnection)||void 0===n||n.on("ReceiveComment",(function(e){Object(l.h)((function(){t.selectedGroup.comments.push(e)}))}))}catch(r){console.log(r)}},this.stopHubConnection=Object(m.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t.hubConnection){e.next=5;break}if("Connected"!==t.hubConnection.state){e.next=5;break}return e.next=5,t.hubConnection.invoke("RemoveFromGroup",t.selectedGroupId).then((function(){t.hubConnection.stop()})).then((function(){return console.log("Connection stopped")})).catch((function(e){return console.log(e)}));case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),Object(l.h)((function(){return console.log(e.t0)}));case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),this.addComment=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.groupId=t.selectedGroupId,e.prev=1,e.next=4,t.hubConnection.invoke("SendComment",n);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),this.addAnnouncement=function(){var e=Object(m.a)(f.a.mark((function e(n,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.submittingAnnouncement=!0,e.prev=1,e.next=4,w.Groups.addAnnouncement(n,r);case 4:Object(l.h)((function(){t.groupRegistry.get(n).announcements.push(r),t.submittingAnnouncement=!1})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),Object(l.h)((function(){t.submittingAnnouncement=!1,console.log(e.t0)}));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}(),this.deleteAnnouncement=function(){var e=Object(m.a)(f.a.mark((function e(n,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.submittingAnnouncement=!0,e.prev=1,e.next=4,w.Groups.delAnnouncement(n,r);case 4:Object(l.h)((function(){t.groupRegistry.get(n).announcements=t.groupRegistry.get(n).announcements.filter((function(e){return e.id!==r})),t.submittingAnnouncement=!1})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),Object(l.h)((function(){t.submittingAnnouncement=!1,console.log(e.t0)}));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}(),this.uploadPhoto=function(){var e=Object(m.a)(f.a.mark((function e(n,r){var i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingGroupPhoto=!0,e.prev=1,e.next=4,w.Groups.uploadPhoto(n,r);case 4:i=e.sent,Object(l.h)((function(){t.groupRegistry.get(n).photos.push(i),t.loadingGroupPhoto=!1})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0),Object(l.h)((function(){t.loadingGroupPhoto=!1}));case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),this.deletePhoto=function(){var e=Object(m.a)(f.a.mark((function e(n,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.deletingGroupPhoto=!0,e.prev=1,e.next=4,w.Groups.deletePhoto(n,r.id);case 4:Object(l.h)((function(){t.groupRegistry.get(n).photos=[],t.deletingGroupPhoto=!1})),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),Object(l.h)((function(){t.deletingGroupPhoto=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}(),this.addAdminComment=function(){var e=Object(m.a)(f.a.mark((function e(n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r={groupId:"",username:"",body:""}).groupId=t.selectedGroupId,r.username=n.username,r.body="User ".concat(n.username," has ").concat(n.status," the group!"),e.prev=4,e.next=7,t.hubConnection.invoke("SendAdminComment",r);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(t){return e.apply(this,arguments)}}(),this.addAdmin=function(){var e=Object(m.a)(f.a.mark((function e(n,r){var i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isPromotingMember=!0,e.prev=1,i={username:r},e.next=5,w.Groups.editMember(n,i);case 5:Object(l.h)((function(){var e;null===(e=t.selectedGroup)||void 0===e||e.members.forEach((function(e){e.username===r&&(e.isAdmin=!0)})),console.log("Is he admin? ",t.selectedGroup),t.isPromotingMember=!1})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(l.h)((function(){console.log(e.t0),t.isPromotingMember=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}(),this.loadGroups=Object(m.a)(f.a.mark((function e(){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingGroups=!0,e.prev=1,e.next=4,w.Groups.list();case 4:n=e.sent,Object(l.h)((function(){n.forEach((function(e){e.createdAt=e.createdAt.split(".")[0],t.groupRegistry.set(e.id,e)})),t.loadingGroups=!1})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(l.h)((function(){t.loadingGroups=!1,console.log("Error loading group: ",e.t0)}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),this.createGroup=function(){var e=Object(m.a)(f.a.mark((function e(n){var r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.submittingGroup=!0,e.prev=1,e.next=4,w.Groups.create(n);case 4:r=[],o=L.userStore.user,(i={displayName:o.displayName,isHost:!1,username:o.username,image:o.image,isAdmin:!1}).isHost=!0,r.push(i),n.members=r,n.comments=[],n.announcements=[],n.photos=[],Object(l.h)((function(){t.groupRegistry.set(n.id,n),t.submittingGroup=!1,t.setSelectedGroup(n.id)})),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),Object(l.h)((function(){t.submittingGroup=!1,console.log("Error in createGroup: ",e.t0)}));case 18:case"end":return e.stop()}var o}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),this.editGroupDescription=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.isUploadingGroupEdit=!0,e.prev=1,console.log("Sending up: ",n),e.next=5,w.Groups.update(n);case 5:Object(l.h)((function(){t.groupRegistry.set(n.id,n),t.isUploadingGroupEdit=!1})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),Object(l.h)((function(){console.log(e.t0),t.isUploadingGroupEdit=!1}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),this.setSelectedGroup=function(e){try{t.selectedGroupId=e}catch(n){console.log("Error setting selected group: ",n)}},this.setSelectedGroupEmpty=function(){try{t.selectedGroupId=""}catch(e){console.log("Error setting selected group Empty : ",e)}},this.joinGroup=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.submittingGroup=!0,e.prev=1,e.next=4,w.Groups.join(n);case 4:Object(l.h)((function(){t.selectedGroup.members.push(L.userStore.user),t.submittingGroup=!1})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),Object(l.h)((function(){t.submittingGroup=!1,console.log("Error in joinGroup: ",e.t0)}));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),this.leaveGroup=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.submittingGroup=!0,e.prev=1,e.next=4,w.Groups.leave(n);case 4:Object(l.h)((function(){t.selectedGroup.members=t.selectedGroup.members.filter((function(e){var t;return e.username!==(null===(t=L.userStore.user)||void 0===t?void 0:t.username)})),t.selectedGroupId="",t.submittingGroup=!1})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),Object(l.h)((function(){t.selectedGroupId="",t.submittingGroup=!1,console.log("Error in leaveGroup: ",e.t0)}));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),Object(l.e)(this)}return Object(x.a)(e,[{key:"isHostOfGroup",get:function(){return this.selectedGroup.members.filter((function(e){var t;return e.isHost&&e.username===(null===(t=L.userStore.user)||void 0===t?void 0:t.username)})).length>0}},{key:"isHostOrAdminOfGroup",get:function(){var e;return(null===(e=this.selectedGroup)||void 0===e?void 0:e.members.filter((function(e){var t;return(e.isHost||e.isAdmin)&&e.username===(null===(t=L.userStore.user)||void 0===t?void 0:t.username)})).length)>0}},{key:"getGroups",get:function(){return Array.from(this.groupRegistry.values())}},{key:"groupsByDate",get:function(){return Array.from(this.groupRegistry.values()).slice().sort((function(e,t){return Date.parse(e.createdAt)-Date.parse(t.createdAt)}))}},{key:"groupTitles",get:function(){return Array.from(this.groupRegistry.values()).slice().sort((function(e,t){var n;return null===(n=e.groupName)||void 0===n?void 0:n.charAt(0).localeCompare(t.groupName.charAt(0))})).map((function(e){return{key:e.id,value:e.id,text:e.groupName}}))}},{key:"groupTitleForUserOptions",get:function(){return Array.from(this.groupRegistry.values()).slice().sort((function(e,t){var n;return null===(n=e.groupName)||void 0===n?void 0:n.charAt(0).localeCompare(t.groupName.charAt(0))})).filter((function(e){var t;return null===(t=e.members)||void 0===t?void 0:t.filter((function(e){var t;return e.username===(null===(t=L.userStore.user)||void 0===t?void 0:t.username)})).length})).map((function(e){return{key:e.id,value:e.id,text:e.groupName}}))}},{key:"selectedGroup",get:function(){var e=this;return Array.from(this.groupRegistry.values()).find((function(t){return t.id===e.selectedGroupId}))}},{key:"groupTitleForUser",get:function(){return Array.from(this.groupRegistry.values()).slice().sort((function(e,t){var n;return null===(n=e.groupName)||void 0===n?void 0:n.charAt(0).localeCompare(t.groupName.charAt(0))})).filter((function(e){var t;return null===(t=e.members)||void 0===t?void 0:t.filter((function(e){var t;return e.username===(null===(t=L.userStore.user)||void 0===t?void 0:t.username)})).length})).map((function(e){var t;return{key:e.id,value:e.id,text:e.groupName,photo:null===(t=e.photos)||void 0===t?void 0:t.slice(0,1)[0]}}))}}]),e}(),R=Object(A.a)(F.prototype,"hubConnection",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F);Object(l.c)({enforceActions:"always"});var L={ticketStore:new C,commonStore:new function e(){var t=this;Object(g.a)(this,e),this.error=null,this.token=window.localStorage.getItem("jwt"),this.appLoaded=!1,this.setToken=function(e){t.token=e},this.setAppLoaded=function(){Object(l.h)((function(){t.appLoaded=!0}))},this.setServerError=function(e){t.error=e},Object(l.e)(this),Object(l.g)((function(){return t.token}),(function(e){e?window.localStorage.setItem("jwt",e):window.localStorage.removeItem("jwt")}))},userStore:new T,profileStore:new S,groupStore:new D},M=Object(i.createContext)(L);function N(){return Object(i.useContext)(M)}var U=Object(d.a)((function(){var e,t,n=N().commonStore;return Object(r.jsxs)(p.a,{children:[Object(r.jsx)(j.a,{as:"h1",content:"Server Error",color:"teal"}),Object(r.jsx)(j.a,{sub:!0,as:"h5",color:"red",content:null===(e=n.error)||void 0===e?void 0:e.message}),(null===(t=n.error)||void 0===t?void 0:t.details)&&Object(r.jsxs)(b.a,{children:[Object(r.jsx)(j.a,{as:"h4",content:"Stack trace",color:"teal"}),Object(r.jsx)("code",{style:{marginTop:"10px"},children:n.error.details})]})]})})),H=n(12),B=n(206),z=n(126),_=n(262),V=n(277),q=n(205),Y=function(){return Object(r.jsx)(b.a,{placeholder:!0,children:Object(r.jsxs)(j.a,{icon:!0,children:[Object(r.jsx)(q.a,{src:"/assets/bugHunter-grp.png",alt:"logo",style:{marginRight:"10px",width:"60px",height:"60px"}}),"Select what Group to view from the dropdown above. If no Group is available, you can create your own aswell!"]})})},W=n(287),J=n(67),Z=Object(d.a)((function(e){var t=e.group,n=N().groupStore,i=n.joinGroup,o=n.submittingGroup,c=t.groupName,a=t.description,s=t.id;return Object(r.jsxs)(W.a.Group,{style:{margin:"10px"},children:[Object(r.jsx)(W.a,{children:Object(r.jsx)(W.a.Content,{style:{margin:"10px"},verticalAlign:"middle",children:Object(r.jsx)(W.a.Header,{style:{color:"white"},children:c})})}),Object(r.jsx)(V.a,{}),Object(r.jsx)(W.a,{children:Object(r.jsxs)(W.a.Content,{style:{margin:"10px"},children:[Object(r.jsxs)(W.a.Description,{style:{color:"white"},children:["Description: ",a," "]}),Object(r.jsxs)(W.a.Description,{style:{color:"white"},children:["Alive since ",t.createdAt.split("T")[0]]}),Object(r.jsxs)(W.a.Extra,{children:[Object(r.jsxs)("h4",{style:{color:"white"},children:["Issue Status:","    "," "]}),Object(r.jsxs)(J.a,{color:"blue",name:"circle",children:["    ",t.open,"    "]}),Object(r.jsxs)(J.a,{color:"green",name:"circle",children:["    ",t.verify,"    "]}),Object(r.jsxs)(J.a,{color:"red",name:"circle",children:["    ",t.closed,"    "]})]}),Object(r.jsx)(_.a,{loading:o,positive:!0,onClick:function(){return i(s)},children:"Join Group"})]})})]})})),Q=n(22),X=n(284),K=n(292),$=n(20),ee=n(123),te=function(e){var t=e.input,n=e.width,i=e.type,o=e.placeholder,c=e.meta,a=c.touched,s=c.error;return Object(r.jsxs)(X.a.Field,{error:a&&!!s,type:i,width:n,children:[Object(r.jsx)("input",Object(Q.a)(Object(Q.a)({},t),{},{placeholder:o,name:i,autoComplete:"on"})),a&&s&&Object(r.jsx)(ee.a,{basic:!0,color:"red",children:s})]})},ne=function(e){var t=e.input,n=e.width,i=e.rows,o=e.placeholder,c=e.meta,a=c.touched,s=c.error;return Object(r.jsxs)(X.a.Field,{error:a&&!!s,width:n,children:[Object(r.jsx)("textarea",Object(Q.a)(Object(Q.a)({rows:i},t),{},{placeholder:o})),a&&s&&Object(r.jsx)(ee.a,{basic:!0,color:"red",children:s})]})},re=n(300),ie=function(e){var t=e.input,n=t.onChange,i=t.name,o=t.checked,c=e.label;e.input;return Object(r.jsx)(re.a,{name:i,checked:o,onChange:function(e,t){var r=t.checked;return n(r)},label:c})},oe=function(e){return e?void 0:"Required"},ce=function(e){return function(t){return t.length>e||t>=e?void 0:"Should be atleast ".concat(e," characters long.")}},ae=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(t,n){return t||n(e)}),void 0)}},se=Object(d.a)((function(e){var t=e.setCreatingGroup,n=e.setSelectedGroup,o=N().groupStore,c=Object(i.useState)((function(){return{id:"",groupName:"",description:"",isPublic:!0,createdAt:(new Date).toISOString(),open:0,closed:0,verify:0}})),a=Object(H.a)(c,2),s=a[0],u=(a[1],function(){var e=Object(m.a)(f.a.mark((function e(r){var i,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==s.id.length){e.next=10;break}return i=!r.isPublic,c=Object(Q.a)(Object(Q.a)({},s),{},{id:Object(K.a)(),groupName:r.groupName,description:r.description,isPublic:i}),e.next=5,o.createGroup(c);case 5:console.log("Group created successfully"),n(c.id),t(!1),e.next=10;break;case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return Object(r.jsxs)(b.a,{children:[Object(r.jsx)("h3",{style:{justifyContent:"center"},children:"Create a new Group"}),Object(r.jsx)($.b,{initialValues:s,onSubmit:u,render:function(e){var i=e.handleSubmit,c=e.invalid,a=e.pristine;return Object(r.jsxs)(X.a,{onSubmit:i,children:[Object(r.jsx)($.a,{validate:ae(oe,ce(2)),name:"groupName",placeholder:"Group Name",value:s.groupName,component:te}),Object(r.jsx)($.a,{name:"isPublic",type:"checkbox",label:"Make Group Private (hidden from search)",component:ie}),Object(r.jsx)($.a,{validate:ae(oe,ce(10)),rows:2,name:"description",placeholder:"Description",value:s.description,component:ne}),Object(r.jsx)(_.a,{disabled:o.submittingGroup||c||a,loading:o.submittingGroup,type:"submit",positive:!0,children:"Submit Group"}),Object(r.jsx)(_.a,{onClick:function(){t(!1),n(null)},type:"button",children:"Cancel"})]})}})]})})),ue=n(296),le=n(280),de=function(e){var t=e.inverted,n=void 0!==t&&t,i=e.content;return Object(r.jsx)(ue.a,{active:!0,inverted:n,style:{backgroundColor:"rgb(7, 20, 38)"},children:Object(r.jsx)(le.a,{content:i,style:{color:"white",backgroundImage:"#bc4123"}})})},pe=n(288),je=n(282),be={borderColor:"orange",borderWidth:2},he=function(e){return e.map((function(e){return{key:e.username,text:e.displayName,value:e.username,image:{avatar:!0,src:e.image||"/assets/user.png"}}}))},fe=Object(d.a)((function(e){var t=e.admins,n=e.members,o=e.isHostOrAdmin,c=N().groupStore,a=c.isPromotingMember,s=c.selectedGroupId,u=c.addAdmin,l=Object(i.useState)(""),d=Object(H.a)(l,2),p=d[0],j=d[1];return Object(r.jsxs)("div",{children:[Object(r.jsxs)(pe.a,{horizontal:!0,relaxed:"very",floated:"left",style:{marginLeft:"14px"},children:[Object(r.jsxs)(pe.a.Item,{children:[Object(r.jsx)("b",{children:"Admins "})," "]}),t.map((function(e){return Object(r.jsx)(pe.a.Item,{children:Object(r.jsx)(je.a,{header:e.displayName,trigger:Object(r.jsx)(q.a,{bordered:!0,style:e.isHost?be:null,size:"mini",circular:!0,src:e.image||"/assets/user.png"})})},e.username)}))]}),o&&Object(r.jsx)(pe.a,{horizontal:!0,floated:"right",children:Object(r.jsxs)(pe.a.Item,{style:{maxHeight:"32px"},children:[Object(r.jsx)(z.a,{style:{borderTopRightRadius:0,borderBottomRightRadius:0,minWidth:"10em"},clearable:!0,labeled:!0,selection:!0,placeholder:"Promote",options:he(n),onChange:function(e,t){var n=t.value.toLowerCase();"Promote"===t.placeholder&&n&&j(n),n||j("")}}),Object(r.jsx)(_.a,{style:{borderTopLeftRadius:0,borderBottomLeftRadius:0,height:"38px",paddingTop:"0px",paddingBottom:"0px",marginBottom:"3px",marginRight:"9px"},loading:a,disabled:""===p,size:"medium",positive:!0,icon:"add",onClick:function(){return p&&u(s,p)}})]})})]})})),me=n(298),ge=n(291),xe=function(e){var t=e.announcements,n=e.isHostOrAdminOfGroup,o=e.groupId,c=e.deleteAnnouncement,a=e.submittingAnnouncement,s=Object(i.useState)(null),u=Object(H.a)(s,2),l=u[0],d=u[1],p=Object(i.useState)(""),j=Object(H.a)(p,2),h=(j[0],j[1]),f=Object(i.useState)(""),m=Object(H.a)(f,2),g=m[0],x=m[1];return Object(r.jsx)(b.a,{style:{backgroundColor:"rgb(7, 20, 38)",border:"1px solid rgba(255,255,255,0.4)"},children:Object(r.jsx)(ge.a,{fluid:!0,exclusive:!1,inverted:!0,children:null===t||void 0===t?void 0:t.map((function(e,t){return Object(r.jsxs)(pe.a.Item,{style:{paddingTop:"14px",paddingBottom:"14px"},children:[Object(r.jsxs)(ge.a.Title,{onClick:function(t,n){h(e.id),function(e,t){var n=t.index;d(l===n?-1:n)}(0,n)},active:l===t,index:t,children:[n&&Object(r.jsx)(je.a,{header:"Delete announcement",trigger:Object(r.jsx)(_.a,{icon:"cancel",onClick:function(){x(e.id),c(o,e.id)},floated:"right",loading:a&&e.id===g})},e.id),Object(r.jsx)(q.a,{avatar:!0,floated:"left",src:e.image||"/assets/user.png"}),"   ",Object(r.jsxs)("span",{style:{color:"white",fontSize:"12px"},children:[Object(me.a)(new Date(e.createdAt),new Date)," ","ago."]}),Object(r.jsxs)("p",{children:[Object(r.jsx)(J.a,{name:"dropdown"}),e.body.split("\n")[0]]})]}),Object(r.jsx)(ge.a.Content,{active:l===t,children:Object(r.jsx)("span",{style:{color:"white",whiteSpace:"pre-wrap"},children:e.body.match(/[^\n]*\n|[^\n]+/g).slice(1)})})]},e.id)}))})})},Oe=n(286),ve=Object(d.a)((function(e){var t=e.isAnnouncement,n=N(),o=n.groupStore,c=n.userStore,a=Object(i.useState)(!1),s=Object(H.a)(a,2),u=s[0],l=s[1],d=function(){var e=Object(m.a)(f.a.mark((function e(n){var r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=7;break}return i={body:n.body,username:c.user.username,displayName:c.user.displayName,createdAt:new Date,image:null===(r=c.user)||void 0===r?void 0:r.image,id:Object(K.a)()},e.next=5,o.addAnnouncement(o.selectedGroupId,i);case 5:e.next=9;break;case 7:return e.next=9,o.addComment(n);case 9:l(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log("Error catched submitting announcement: ",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)(Oe.a,{children:u?Object(r.jsx)($.b,{onSubmit:function(e){return d(e)},render:function(e){var n=e.handleSubmit,i=e.submitting,o=e.form;return Object(r.jsxs)(X.a,{onSubmit:function(){return n().then((function(){console.log("Submitted"),o.reset()}))},children:[Object(r.jsx)($.a,{name:"body",component:ne,rows:2,placeholder:t?"Add your Announcement":"Add Comment"}),Object(r.jsx)(_.a,{content:t?"Create":"Add Reply",labelPosition:"left",icon:"edit",primary:!0,loading:i}),Object(r.jsx)(_.a,{content:"Cancel",labelPosition:"right",icon:"cancel",type:"button",onClick:function(){return l(!1)}})]})}}):Object(r.jsx)(_.a,{labelPosition:"right",icon:"add",content:t?"Announcement":"Comment",inverted:!0,style:{marginTop:t&&"10px",backgroundColor:"#bc4123"},onClick:function(){return l(!0)}})})})),ke=function e(t){Object(g.a)(this,e),this.description="",this.description=t},ye=function(e){return e?void 0:"Required"},we=function(e){var t=e.description,n=e.handleFinalFormSubmit,o=e.isUploadingGroupEdit,c=Object(i.useState)(new ke),a=Object(H.a)(c,2),s=a[0],u=a[1];return Object(i.useEffect)((function(){t!==s.description&&u(new ke(t))}),[t,s]),Object(r.jsx)($.b,{initialValues:s,onSubmit:n,render:function(e){var t=e.handleSubmit,n=e.invalid,i=e.pristine;return Object(r.jsxs)(X.a,{onSubmit:t,children:[Object(r.jsx)($.a,{validate:ye,placeholder:"Description",value:s.description,name:"description",component:ne}),Object(r.jsx)(_.a,{disabled:n||i,loading:o,floated:"right",positive:!0,type:"submit",content:"submit"})]})}})},Ce=n(27),Te=Object(d.a)((function(){var e=N().groupStore,t=e.stopHubConnection,n=e.selectedGroup;return Object(i.useEffect)((function(){return function(){t()}}),[t]),Object(r.jsxs)(i.Fragment,{children:[Object(r.jsx)(b.a,{size:"mini",textAlign:"center",attached:"top",inverted:!0,style:{border:"2px solid #bc4123",background:"linear-gradient(135deg, #071426 0%, #000000 99%)"},children:Object(r.jsxs)(j.a,{size:"medium",children:[n.groupName," chat"]})}),Object(r.jsx)(b.a,{attached:!0,textAlign:"left",style:{overflow:"auto",maxHeight:320,border:"2px solid #bc4123"},children:Object(r.jsxs)(Oe.a.Group,{children:[Object(r.jsx)(ve,{isAnnouncement:!1}),n&&n.comments&&n.comments.slice().reverse().map((function(e){return null!==e.username?Object(r.jsxs)(Oe.a,{children:[Object(r.jsx)(Oe.a.Avatar,{src:e.image||"/assets/user.png"}),Object(r.jsxs)(Oe.a.Content,{children:[Object(r.jsx)(Oe.a.Author,{as:Ce.a,to:"/profile/".concat(e.username),children:e.displayName}),Object(r.jsx)(Oe.a.Metadata,{children:Object(r.jsx)("div",{children:Object(me.a)(new Date(e.createdAt),new Date)})}),Object(r.jsx)(Oe.a.Text,{style:{whiteSpace:"pre-wrap"},children:e.body})]})]},e.id):Object(r.jsx)(Oe.a,{children:Object(r.jsx)(Oe.a.Content,{children:Object(r.jsx)(Oe.a.Text,{style:{fontStyle:"italic",color:"green"},children:e.body})})},e.id)}))]})})]})})),Se={border:"1px solid",borderRadius:"50%",width:"20px",height:"20px",display:"inline-block",marginLeft:"4px"},Pe=function(e){var t,n=e.group;return Object(r.jsxs)("div",{style:{backgroundColor:"rgb(7, 20, 38)",color:"white"},children:[Object(r.jsxs)(pe.a,{horizontal:!0,floated:"left",children:[Object(r.jsxs)(pe.a.Item,{children:["Alive since ",n.createdAt.split("T")[0]]}),Object(r.jsxs)(pe.a.Item,{children:["Members: ",null===(t=n.members)||void 0===t?void 0:t.length]})]}),Object(r.jsx)(pe.a,{horizontal:!0,floated:"right",children:Object(r.jsxs)(pe.a.Item,{children:[Object(r.jsx)("span",{style:Object(Q.a)({color:"blue"},Se),children:n.open}),Object(r.jsx)("span",{style:Object(Q.a)({color:"green"},Se),children:n.verify}),Object(r.jsx)("span",{style:Object(Q.a)({color:"red"},Se),children:n.closed})]})})]})},Ae=n(117),Ge=function(e){var t=e.groupId,n=e.deletePhoto,i=e.groupName,o=e.photo,c=e.isHostOrAdminOfGroup,a=e.loadingGroupPhoto,s=e.deletingGroupPhoto,u=e.setIsAddingPhoto,l=e.isAddingPhoto;return Object(r.jsx)(b.a,{basic:!0,style:{marginTop:"0px",marginBottom:"0px",padding:"0px",backgroundColor:"rgb(7, 20, 38)"},children:Object(r.jsxs)(B.a,{columns:"two",children:[Object(r.jsxs)(B.a.Column,{textAlign:"left",width:4,children:[Object(r.jsx)(j.a,{floated:"left",as:"h2",style:{marginRight:"0px"},children:Object(r.jsx)(q.a,{style:{margin:"0px",marginRight:"2px",width:"73px",height:"73px",border:"1px solid rgb(255, 255, 255, 0.5)"},rounded:!0,src:(null===o||void 0===o?void 0:o.url)||"/assets/user.png"})}),c&&Object(r.jsxs)(B.a.Row,{textAlign:"left",children:[(null===o||void 0===o?void 0:o.url)&&Object(r.jsx)(B.a.Column,{children:Object(r.jsx)(je.a,{header:"Delete Group Photo",trigger:Object(r.jsx)(_.a,{style:{border:"1px solid black",fontSize:"small",marginLeft:"0px",marginRight:"0px"},negative:!0,icon:"cancel",onClick:function(){n(t,o)},loading:s})})}),!(null===o||void 0===o?void 0:o.url)&&Object(r.jsx)(B.a.Column,{children:Object(r.jsx)(je.a,{header:"Add Group Photo",trigger:Object(r.jsx)(_.a,{style:{border:"1px solid black",fontSize:"small",marginTop:"2px",marginLeft:"0px",marginRight:"0px"},positive:!0,icon:"add",onClick:function(){u(!l)},loading:a})})})]})]}),Object(r.jsx)(Ae.a,{children:Object(r.jsx)(j.a,{as:"h1",style:{marginTop:"0px",textAlign:"center",color:"white"},children:i})})]})})},Ie=n(203),Fe={border:"dashed 3px",borderColor:"#eee",borderRadius:"5px",paddingTop:"30px",textAlign:"center",height:"200px"},Re={borderColor:"green"},Ee={borderColor:"#979797",borderRadius:"1px",width:"133px",textAlign:"center"},De=function(e){var t=e.setFiles,n=e.isTicket,o=e.children,c=Object(i.useCallback)((function(e){t(e.map((function(e){return Object.assign(e,{preview:URL.createObjectURL(e)})})))}),[t]),a=Object(Ie.a)({onDrop:c}),s=a.getRootProps,u=a.getInputProps,l=a.isDragActive;return Object(r.jsxs)("div",Object(Q.a)(Object(Q.a)({},s()),{},{style:n?Object(Q.a)({},Ee):l?Object(Q.a)(Object(Q.a)({},Fe),Re):Fe,children:[Object(r.jsx)("input",Object(Q.a)({},u())),n?o:Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(J.a,{name:"upload",size:"huge"}),Object(r.jsx)(j.a,{content:"Drop image here",style:{color:"teal"}})]})]}))},Le=n(198),Me=(n(254),function(e){var t=e.setImage,n=e.imagePreview,o=Object(i.useRef)(null);return Object(r.jsx)(Le.a,{ref:o,src:n,style:{height:200,width:"100%"},initialAspectRatio:1,preview:".img-preview",guides:!1,viewMode:1,dragMode:"move",scalable:!0,cropBoxMovable:!0,cropBoxResizable:!0,crop:function(){var e=null===o||void 0===o?void 0:o.current,n=null===e||void 0===e?void 0:e.cropper;"undefined"!==typeof n&&n.getCroppedCanvas().toBlob((function(e){t(e)}),"image/jpeg")}})}),Ne=Object(d.a)((function(e){var t=e.loading,n=e.uploadPhoto,o=e.isGroup,c=e.groupId,a=e.setIsAddingPhoto,s=Object(i.useState)([]),u=Object(H.a)(s,2),l=u[0],d=u[1],p=Object(i.useState)(null),b=Object(H.a)(p,2),h=b[0],f=b[1];return Object(i.useEffect)((function(){return function(){l.forEach((function(e){return URL.revokeObjectURL(e.preview)}))}})),Object(r.jsx)(i.Fragment,{children:Object(r.jsxs)(B.a,{children:[Object(r.jsxs)(B.a.Column,{width:4,children:[Object(r.jsx)(j.a,{color:"teal",sub:!0,content:"Step 1 - Add Photo"}),Object(r.jsx)(De,{setFiles:d})]}),Object(r.jsx)(B.a.Column,{width:1}),Object(r.jsxs)(B.a.Column,{width:4,children:[Object(r.jsx)(j.a,{sub:!0,color:"teal",content:"Step 2 - Resize image"}),l.length>0&&Object(r.jsx)(Me,{setImage:f,imagePreview:l[0].preview})]}),Object(r.jsx)(B.a.Column,{width:1}),Object(r.jsxs)(B.a.Column,{width:4,children:[Object(r.jsx)(j.a,{sub:!0,color:"teal",content:"Step 3 - Preview & Upload"}),l.length>0&&Object(r.jsxs)(i.Fragment,{children:[Object(r.jsx)("div",{className:"img-preview",style:{minHeight:"200px",overflow:"hidden"}}),Object(r.jsxs)(_.a.Group,{width:2,children:[Object(r.jsx)(_.a,{positive:!0,icon:"check",loading:t,onClick:function(){o?n(c,h).then((function(){return a(!1)})):n(h)}}),Object(r.jsx)(_.a,{icon:"close",disabled:t,onClick:function(){return d([])}})]})]})]})]})})})),Ue=function(e){var t=e.groupId,n=e.uploadPhoto,i=e.loading,o=e.setIsAddingPhoto;return Object(r.jsxs)(b.a,{children:[Object(r.jsx)("p",{children:"Upload photo"}),Object(r.jsx)(Ne,{groupId:t,uploadPhoto:n,loading:i,isGroup:!0,setIsAddingPhoto:o})]})},He=Object(d.a)((function(e){var t,n,o=e.group,c=o.groupName,a=o.description,s=o.id,u=o.members,l=o.photos,d=N().groupStore,p=d.stopHubConnection,j=d.leaveGroup,h=d.submittingGroup,g=d.isHostOfGroup,x=d.createHubConnection,O=d.selectedGroupId,v=d.isHostOrAdminOfGroup,k=d.deleteAnnouncement,y=d.submittingAnnouncement,w=d.uploadPhoto,C=d.deletePhoto,T=d.editGroupDescription,S=d.isUploadingGroupEdit,P=d.loadingGroupPhoto,A=d.deletingGroupPhoto,G=d.selectedGroup,I=Object(i.useState)(!1),F=Object(H.a)(I,2),R=F[0],E=F[1],D=Object(i.useState)(!1),L=Object(H.a)(D,2),M=L[0],U=L[1];Object(i.useEffect)((function(){return x(O),function(){p()}}),[x,O,p]);var B=function(){var e=Object(m.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(n=G).description=t.description,e.next=5,T(n);case 5:U(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)(W.a.Group,{divided:!0,style:{margin:"10px",backgroundColor:"rgb(7, 20, 38) ",border:"1px solidrgba(255,255,255,0.4)"},children:Object(r.jsx)(W.a,{children:Object(r.jsxs)(W.a.Content,{style:{margin:"10px"},verticalAlign:"middle",children:[Object(r.jsx)(W.a,{children:Object(r.jsxs)(W.a.Content,{style:{margin:"10px"},children:[Object(r.jsx)(Ge,{groupId:O,deletePhoto:C,groupName:c,photo:{id:l?null===l||void 0===l||null===(t=l.slice(0,1)[0])||void 0===t?void 0:t.id:void 0,url:l?null===l||void 0===l||null===(n=l.slice(0,1)[0])||void 0===n?void 0:n.url:void 0},isHostOrAdminOfGroup:v,loadingGroupPhoto:P,deletingGroupPhoto:A,setIsAddingPhoto:E,isAddingPhoto:R}),Object(r.jsx)(b.a,{clearing:!0,style:{backgroundColor:"rgb(7, 20, 38)",color:"white",border:"none"},children:M?Object(r.jsxs)("div",{children:[Object(r.jsx)(we,{handleFinalFormSubmit:B,description:a,isUploadingGroupEdit:S}),Object(r.jsx)(_.a,{floated:"right",icon:"cancel",onClick:function(){return U(!1)}})]}):Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)(W.a.Description,{style:{whiteSpace:"pre-wrap"},children:[a," "]}),v&&Object(r.jsx)(_.a,{floated:"right",icon:"edit",onClick:function(){return U(!0)}})]})}),v&&R&&Object(r.jsx)(Ue,{groupId:O,uploadPhoto:w,loading:P,setIsAddingPhoto:E}),Object(r.jsxs)(W.a.Description,{children:[Object(r.jsx)(b.a,{clearing:!0,attached:!0,style:{padding:"6px",borderRadius:"4px",border:"1px solid rgba(255,255,255,0.4)",backgroundColor:"rgb(7, 20, 38)",color:"white"},children:Object(r.jsx)(fe,{admins:u.filter((function(e){return e.isAdmin||e.isHost})),members:u.filter((function(e){return!e.isAdmin&&!e.isHost})),isHostOrAdmin:v})}),v&&Object(r.jsx)(ve,{isAnnouncement:!0}),o.announcements.length>0&&Object(r.jsx)(xe,{groupId:O,announcements:o.announcements,isHostOrAdminOfGroup:v,deleteAnnouncement:k,submittingAnnouncement:y})]})]})}),Object(r.jsx)(V.a,{}),Object(r.jsx)(Te,{}),Object(r.jsxs)(W.a.Content,{children:[Object(r.jsx)(W.a.Extra,{children:Object(r.jsx)(Pe,{group:o})}),Object(r.jsx)(_.a,{loading:h,negative:!0,disabled:g,onClick:function(){return j(s)},children:"Leave Group"})]})]})})})})),Be=Object(d.a)((function(){var e=Object(u.g)(),t=N(),n=t.groupStore,o=t.userStore,c=n.loadGroups,a=n.setSelectedGroupEmpty,s=n.selectedGroupId,l=o.user,d="profileGroups"===e.location.state,p=Object(i.useState)(d?s:null),j=Object(H.a)(p,2),h=j[0],g=j[1],x=Object(i.useState)(!1),O=Object(H.a)(x,2),v=O[0],k=O[1];Object(i.useEffect)((function(){function e(){return(e=Object(m.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(!d&&""===s||d&&""===s)&&function(){e.apply(this,arguments)}(),function(){}}),[s,c,a,d]);var y=function(){var e=Object(m.a)(f.a.mark((function e(t,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=3;break}return e.next=3,n.stopHubConnection();case 3:n.setSelectedGroup(r.value),g(r.value);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return n.loadingGroups?Object(r.jsx)(de,{content:"Loading Groups..."}):v?Object(r.jsx)(se,{setCreatingGroup:k,setSelectedGroup:g}):Object(r.jsx)(b.a,{clearing:!0,style:{border:"2px solid #bc4123"},children:Object(r.jsxs)(B.a,{style:{margin:"0px",marginBottom:"14px"},stackable:!0,children:[Object(r.jsxs)(B.a.Row,{style:{paddingBottom:"0px"},columns:2,children:[Object(r.jsx)(B.a.Column,{floated:"left",style:{margin:"0px",padding:"10px"},children:Object(r.jsx)(z.a,{style:{marginLeft:"0px"},placeholder:"Select Group",selection:!0,defaultValue:h,options:n.groupTitles,onChange:y})}),Object(r.jsx)(B.a.Column,{align:"right",floated:"right",children:Object(r.jsx)(_.a,{style:{margin:"0px"},positive:!0,onClick:function(){return k(!0)},children:"Create Group"})})]}),Object(r.jsx)(V.a,{fitted:!0,style:{marginLeft:"10px",marginRight:"10px",marginBottom:"0px"}}),Object(r.jsx)(B.a.Row,{style:{margin:"10px"},centered:!0,columns:1,children:Object(r.jsx)(b.a,{clearing:!0,style:{backgroundColor:"rgb(7, 20, 38)",border:"none"},children:h?function(e){var t;if(n.selectedGroup){var r=n.selectedGroup,i=!1;return null===(t=r.members)||void 0===t||t.forEach((function(e){e.username===(null===l||void 0===l?void 0:l.username)&&(i=!0)})),i}}()?Object(r.jsx)(He,{group:n.groupsByDate.find((function(e){return e.id===h}))}):Object(r.jsx)(Z,{group:n.groupsByDate.find((function(e){return e.id===h}))}):Object(r.jsx)(Y,{})})})]})})})),ze=n(301),_e=n(104),Ve=n(66),qe=n(293),Ye=function(e){var t=e.error,n=e.text;return console.log("error: ",t," text: ",n),Object(r.jsxs)(qe.a,{error:!0,children:[Object(r.jsx)(qe.a.Header,{children:n}),t&&Object(r.jsx)(qe.a.List,{children:t.length>0&&t.map((function(e,t){return Object(r.jsx)(qe.a.Item,{children:e},t)}))}),"string"===typeof t.data&&Object(r.jsx)(qe.a.Content,{content:t.data})]})},We=function(e){return e?void 0:"Required"},Je=function(){var e=N().userStore.login;return Object(r.jsx)($.b,{onSubmit:function(t){return e(t).catch((function(e){return Object(_e.a)({},Ve.a,e)}))},render:function(e){var t=e.handleSubmit,n=e.submitting,i=e.submitError,o=e.invalid,c=e.pristine,a=e.dirtySinceLastSubmit;return Object(r.jsxs)(X.a,{onSubmit:t,error:!0,autoComplete:"off",children:[Object(r.jsx)(j.a,{as:"h2",content:"Login",textAlign:"center",style:{color:"white"}}),Object(r.jsx)($.a,{name:"email",component:te,placeholder:"Email",validate:We}),Object(r.jsx)($.a,{validate:We,name:"password",component:te,placeholder:"Password",type:"password"}),i&&!a&&Object(r.jsx)(Ye,{error:i,text:"invalid email or password"}),Object(r.jsx)(_.a,{disabled:o&&!a||c,loading:n,color:"teal",content:"Login",fluid:!0,className:"loginButton"})]})}})},Ze=function(e){return e?void 0:"Required"},Qe=function(){var e=N().userStore.register;return Object(r.jsx)($.b,{onSubmit:function(t){return e(t).catch((function(e){return Object(_e.a)({},Ve.a,e)}))},render:function(e){var t=e.handleSubmit,n=e.submitting,i=e.submitError,o=e.invalid,c=e.pristine,a=e.dirtySinceLastSubmit;return Object(r.jsxs)(X.a,{onSubmit:t,error:!0,children:[Object(r.jsx)(j.a,{as:"h2",content:"Sign up",style:{color:"white"},textAlign:"center"}),Object(r.jsx)($.a,{name:"username",component:te,placeholder:"Username",validate:Ze}),Object(r.jsx)($.a,{name:"displayName",component:te,placeholder:"Display Name",validate:Ze}),Object(r.jsx)($.a,{name:"email",component:te,placeholder:"Email",validate:Ze}),Object(r.jsx)($.a,{validate:Ze,name:"password",component:te,placeholder:"Password",type:"password"}),i&&!a&&Object(r.jsx)(Ye,{error:i,text:"Registration failed"}),Object(r.jsx)(_.a,{disabled:o&&!a||c,loading:n,content:"Register",color:"teal",fluid:!0,className:"registerButton"})]})}})},Xe=function(){var e=window.localStorage.getItem("jwt"),t=N().userStore,n=t.isLoggedIn,o=t.user;return Object(r.jsx)(b.a,{inverted:!0,textAlign:"center",vertical:!0,className:"masthead",children:Object(r.jsx)(p.a,{text:!0,children:n&&o&&e?Object(r.jsxs)(i.Fragment,{children:[Object(r.jsx)(j.a,{as:"h2",inverted:!0,content:"Welcome ".concat(o.displayName)}),Object(r.jsx)(_.a,{as:Ce.a,to:"/groups",size:"huge",inverted:!0,children:"Go to groups!"})]}):Object(r.jsxs)(i.Fragment,{children:[Object(r.jsx)(j.a,{as:"h2",inverted:!0,content:"Welcome to Bug hunters!"}),Object(r.jsx)(b.a,{style:{backgroundColor:"rgb(7, 20, 38)",border:"2px solid #bc4123"},children:Object(r.jsx)(ze.a,{menu:{attached:"bottom"},panes:[{menuItem:"Login",render:function(){return Object(r.jsx)(ze.a.Pane,{attached:"top",style:{backgroundColor:"rgb(7, 20, 38)",border:"none"},children:Object(r.jsx)(Je,{})})}},{menuItem:"Register",render:function(){return Object(r.jsx)(ze.a.Pane,{attached:"top",style:{backgroundColor:"rgb(7, 20, 38)",border:"none"},children:Object(r.jsx)(Qe,{})})}}]})})]})})})},Ke=n(201),$e=Object(d.a)((function(){var e=N().userStore,t=e.user,n=e.logout;return Object(r.jsx)(B.a,{children:Object(r.jsx)(Ke.a,{fixed:"top",inverted:!0,children:Object(r.jsxs)(p.a,{style:{border:"none"},children:[Object(r.jsx)(B.a.Column,{children:Object(r.jsx)(Ke.a.Item,{header:!0,as:Ce.b,exact:!0,to:"/",children:Object(r.jsx)("img",{src:"/assets/bugHunter-oranges.png",alt:"logo",style:{marginRight:"10px"}})})}),Object(r.jsx)(Ke.a.Item,{as:Ce.b,to:"/issues",name:"Issues"}),Object(r.jsx)(Ke.a.Item,{as:Ce.b,to:"/groups",name:"Groups"}),Object(r.jsx)(Ke.a.Item,{as:Ce.b,to:"/createTicket",name:"Create Ticket"}),t&&Object(r.jsxs)(Ke.a.Item,{position:"right",children:[Object(r.jsx)(q.a,{avatar:!0,spaced:"right",src:t.image||"/assets/user.png"}),Object(r.jsx)(z.a,{pointing:"top left",text:t.displayName,children:Object(r.jsxs)(z.a.Menu,{children:[Object(r.jsx)(z.a.Item,{as:Ce.a,to:"/profile/".concat(t.username),text:"My profile",icon:"user"}),Object(r.jsx)(z.a.Item,{onClick:n,text:"Logout",icon:"power"})]})})]})]})})})})),et=Object(d.a)((function(){var e=N().groupStore,t=e.groupTitleForUser;return Object(r.jsx)(b.a,{clearing:!0,style:{border:"none"},children:Object(r.jsx)(pe.a,{divided:!0,relaxed:!0,children:t.map((function(t){return Object(r.jsxs)(pe.a.Item,{children:[Object(r.jsx)(q.a,{avatar:!0,src:t.photo&&t.photo.url||"/assets/user.png"}),Object(r.jsx)(pe.a.Content,{children:Object(r.jsx)(pe.a.Header,{as:Ce.a,to:{pathname:"/groups",state:"profileGroups"},onClick:function(){return n=t.key,void e.setSelectedGroup(n);var n},children:t.text})})]},t.key)}))})})})),tt=n(290),nt=Object(d.a)((function(){var e=N().profileStore,t=e.profile,n=e.isCurrentUser,o=e.uploadPhoto,c=e.uploadingPhoto,a=e.setMainPhoto,s=e.loadingMainPhotoSet,u=e.deletePhoto,l=Object(i.useState)(!1),d=Object(H.a)(l,2),p=d[0],b=d[1],h=Object(i.useState)(void 0),g=Object(H.a)(h,2),x=g[0],O=g[1],v=Object(i.useState)(void 0),k=Object(H.a)(v,2),y=k[0],w=k[1],C=function(){var e=Object(m.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o(t).then((function(){return b(!1)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)(ze.a.Pane,{style:{backgroundColor:"rgb(7, 20, 38)",border:"none"},children:Object(r.jsxs)(B.a,{children:[Object(r.jsxs)(B.a.Column,{width:16,style:{paddingBottom:0},children:[Object(r.jsx)(j.a,{icon:"image",content:"photos",style:{color:"white",backgroundImage:"white"}}),n&&Object(r.jsx)(_.a,{floated:"right",style:{backgroundColor:"#bc4123",color:"white"},content:p?"Cancel":"Add Photo",onClick:function(){return b(!p)}})]}),Object(r.jsx)(B.a.Column,{width:16,style:{color:"white"},children:p?Object(r.jsx)(Ne,{uploadPhoto:C,loading:c,isGroup:!1}):Object(r.jsx)(tt.a.Group,{itemsPerRow:5,children:t&&t.photos.map((function(e){return Object(r.jsxs)(tt.a,{children:[Object(r.jsx)(q.a,{src:e.url}),n&&Object(r.jsxs)(_.a.Group,{fluid:!0,width:2,children:[Object(r.jsx)(_.a,{name:e.id,loading:s&&x===e.id,basic:!0,positive:!0,content:"Main",onClick:function(t){O(t.currentTarget.name),a(e)},disabled:e.isMain}),Object(r.jsx)(_.a,{name:e.id,disabled:e.isMain,loading:s&&y===e.id,onClick:function(t){u(e),w(t.currentTarget.name)},basic:!0,negative:!0,icon:"trash"})]})]},e.id)}))})})]})})})),rt=n(289),it=Object(d.a)((function(){var e=N(),t=e.profileStore,n=e.userStore,o=t.profile,c=n.deleteAccount,a=n.isDeletingUser,s=Object(i.useState)(!1),u=Object(H.a)(s,2),l=u[0],d=u[1],p=function(){var e=Object(m.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Delete: ",t),e.next=3,c(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)(b.a,{style:{backgroundColor:"rgb(7, 20, 38)",borderBottom:"2px solid #bc4123",border:"2px solid #bc4123"},children:Object(r.jsx)(B.a,{children:Object(r.jsxs)(B.a.Row,{style:{padding:"14px",margin:"0px"},floated:"left",children:[Object(r.jsx)("p",{style:{marginRight:"10px",paddingTop:"7px",textAlign:"center",color:"white"},children:"Permanently remove your account from Bug Hunters"}),Object(r.jsxs)(rt.a,{open:l,onClose:function(){return d(!1)},onOpen:function(){return d(!0)},size:"mini",trigger:Object(r.jsx)(_.a,{floated:"right",style:{backgroundColor:"#bc4123",borderBottom:"2px solid #bc4123",color:"white"},children:"Delete Account"}),children:[Object(r.jsx)(rt.a.Header,{children:"Delete Your Account"}),Object(r.jsx)(rt.a.Content,{children:"Are you sure you want to delete your account?"}),Object(r.jsxs)(rt.a.Actions,{children:[Object(r.jsx)(_.a,{loading:a,positive:!0,onClick:function(){return p(o.username)},children:"Yes"}),Object(r.jsx)(_.a,{primitive:"true",onClick:function(){return d(!1)},children:"No"})]})]})]})})})})),ot={border:"1px solid",borderRadius:"50%",width:"18px",height:"18px",display:"inline-block",margin:"2px"},ct=function(e){e.circleColor;var t=e.status,n=e.isFilled,i=function(){return"open"===(null===t||void 0===t?void 0:t.toLowerCase())?"blue":"verify"===(null===t||void 0===t?void 0:t.toLowerCase())?"green":"closed"===(null===t||void 0===t?void 0:t.toLowerCase())?"red":void 0};return Object(r.jsx)(je.a,{header:"Status: ".concat(t),trigger:Object(r.jsx)("span",{style:Object(Q.a)({color:i(),backgroundColor:n?i():void 0},ot)})})},at=n(202),st=Object(d.a)((function(){var e=N(),t=e.profileStore,n=e.ticketStore,i=t.profile,o=n.setSelectedTicket;return Object(r.jsx)(b.a,{clearing:!0,style:{border:"none"},children:Object(r.jsx)(pe.a,{divided:!0,relaxed:!0,children:i.tickets.map((function(e){return Object(r.jsxs)(pe.a.Item,{children:[Object(r.jsx)(q.a,{children:Object(r.jsx)(ct,{status:e.status,isFilled:!0})}),Object(r.jsxs)(pe.a.Content,{children:[Object(r.jsx)(pe.a.Header,{as:Ce.a,to:"/ticket/".concat(e.groupId,"/").concat(e.id),onClick:function(){return o(e)},children:e.title}),Object(r.jsx)(pe.a.Description,{as:"a",style:{color:"white"},children:Object(at.a)(new Date(e.date),"eeee do MMMM")})]})]},e.id)}))})})})),ut=Object(d.a)((function(){var e=[{menuItem:"Tickets",render:function(){return Object(r.jsx)(st,{})}},{menuItem:"Groups",render:function(){return Object(r.jsx)(et,{})}},{menuItem:"Photos",render:function(){return Object(r.jsx)(nt,{})}},{menuItem:"Settings",render:function(){return t&&Object(r.jsx)(it,{})}}],t=N().profileStore.isCurrentUser;return Object(r.jsx)(ze.a,{menu:{borderless:!0,attached:!1,tabular:!1},panes:e})})),lt=function e(t){Object(g.a)(this,e),this.displayName="",this.bio="",this.displayName=null===t||void 0===t?void 0:t.displayName,this.bio=null===t||void 0===t?void 0:t.bio},dt=function(e){return e?void 0:"Required"},pt=Object(d.a)((function(e){var t=e.editProfile,n=e.profile,o=e.setEditMode,c=N(),a=c.profileStore,s=c.userStore,u=a.loadingProfileUpdate,l=s.user,d=Object(i.useState)(new lt),p=Object(H.a)(d,2),j=p[0],b=p[1],h=function(){var e=Object(m.a)(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(n);case 3:o(!1),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(i.useEffect)((function(){l&&b(new lt(n))}),[l,n,b]),Object(r.jsx)($.b,{initialValues:j,onSubmit:h,render:function(e){var t=e.handleSubmit,n=e.invalid,i=e.pristine;return Object(r.jsxs)(X.a,{onSubmit:t,loading:u,children:[Object(r.jsx)($.a,{validate:dt,placeholder:"Display Name",value:j.displayName,name:"displayName",component:te}),Object(r.jsx)($.a,{placeholder:"Bio",value:j.bio,name:"bio",rows:3,component:ne}),Object(r.jsx)(_.a,{disabled:u||n||i,loading:u,floated:"right",positive:!0,type:"submit",content:"submit"})]})}})})),jt=function(e){e.description;var t=e.displayName,n=e.userImage,o=N().profileStore,c=o.isCurrentUser,a=o.editProfile,s=o.profile,u=Object(i.useState)(!1),l=Object(H.a)(u,2),d=l[0],p=l[1];return Object(r.jsx)(B.a,{children:Object(r.jsxs)(B.a.Column,{width:16,children:[Object(r.jsxs)(j.a,{size:"huge",style:{color:"white"},children:[Object(r.jsx)(q.a,{fluid:!0,rounded:!0,src:n||"/assets/user.png"}),Object(r.jsx)(j.a.Content,{attached:"top",children:t}),c&&Object(r.jsx)(_.a,{floated:"right",style:{color:"white",backgroundColor:"#bc4123"},content:d?"Cancel":"Edit Profile",onClick:function(){return p(!d)}})]}),Object(r.jsx)(W.a.Description,{floated:"right",style:{color:"white"},children:d?Object(r.jsx)(pt,{editProfile:a,profile:s,setEditMode:p}):Object(r.jsx)("span",{children:s.bio})})]})})},bt=Object(d.a)((function(e){var t=e.match,n=N(),o=n.profileStore,c=n.groupStore,a=o.loadingProfile,s=o.profile,u=o.loadProfile,l=c.loadGroups,d=c.loadingGroups;return Object(i.useEffect)((function(){function e(){return(e=Object(m.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(t.params.username);case 2:return e.next=4,l();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[u,t,l]),a||d?Object(r.jsx)(de,{content:"Loading profile..."}):Object(r.jsx)(B.a,{children:Object(r.jsx)(B.a.Column,{width:16,children:Object(r.jsx)(b.a,{style:{backgroundColor:"rgb(7, 20, 38)",borderBottom:"2px solid #bc4123",border:"2px solid #bc4123"},children:Object(r.jsxs)(W.a.Group,{children:[Object(r.jsx)(W.a,{children:Object(r.jsx)(W.a.Content,{verticalAlign:"top",children:Object(r.jsx)(jt,{userImage:s.image,displayName:s.displayName,description:s.bio})})}),Object(r.jsx)(W.a,{children:Object(r.jsx)(W.a.Content,{verticalAlign:"top",children:Object(r.jsx)(ut,{})})})]})})})})})),ht=function e(t){Object(g.a)(this,e),this.id="",this.title="",this.description="",this.device="",this.date="",this.bugType="",this.status="",this.priority="",this.version="",this.groupId="",this.photos=void 0,this.comments=void 0,this.creator="",this.texts=void 0,Object.assign(this,t)},ft=n(279),mt=function(e){var t=e.input,n=e.width,i=e.options,o=e.placeholder,c=e.meta,a=c.touched,s=c.error;return Object(r.jsxs)(X.a.Field,{error:a&&!!s,width:n,children:[Object(r.jsx)(ft.a,{value:t.value,onChange:function(e,n){return t.onChange(n.value)},placeholder:o,options:i}),a&&s&&Object(r.jsx)(ee.a,{basic:!0,color:"red",children:s})]})},gt=function(e){var t=e.status,n=e.header,o=e.message,c=Object(i.useState)(!0),a=Object(H.a)(c,2),s=a[0],u=a[1];return s?Object(r.jsxs)(qe.a,{onDismiss:function(){return u(!s)},negative:t,children:[Object(r.jsx)(qe.a.Header,{children:n}),Object(r.jsx)(qe.a.Content,{children:o})]}):Object(r.jsx)(r.Fragment,{})},xt=function(e){var t=e.url,n=Object(i.useState)(""),o=Object(H.a)(n,2),c=o[0],a=o[1];Object(i.useEffect)((function(){c||s()}),[]);var s=function(){var e=Object(m.a)(f.a.mark((function e(){var n,r,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t.url?t.url:t.preview).then((function(e){return e.arrayBuffer()}));case 3:n=e.sent,r=new DataView(n),i=new TextDecoder("utf-8"),o=i.decode(r),a(o),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return Object(r.jsx)("div",{style:{whiteSpace:"pre-wrap"},children:c||Object(r.jsx)(le.a,{})})},Ot=function(e){var t=e.img,n=e.isOpen,i=e.id,o=e.setIsModalOpen,c=e.isPhoto;return Object(r.jsxs)(rt.a,{open:n&&i===t.id,onClose:function(){return o(!1)},onOpen:function(){return o(!0)},size:"small",children:[Object(r.jsxs)(rt.a.Header,{children:[Object(r.jsx)(pe.a,{floated:"right",horizontal:!0,children:Object(r.jsx)(pe.a.Item,{href:t.url?t.url:t.preview,children:Object(r.jsx)("p",{children:"Go to file"})})}),Object(r.jsx)(pe.a,{flaoted:"left",horizontal:!0,children:Object(r.jsx)(pe.a.Item,{children:Object(r.jsx)("p",{children:t.name})})})]}),c&&Object(r.jsx)(q.a,{fluid:!0,src:t.url?t.url:t.preview,style:{cursor:"pointer"},onClick:function(){o(!1)}}),!c&&Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(rt.a.Content,{scrolling:!0,children:Object(r.jsx)(xt,{url:t})})})]},i)},vt=Object(d.a)((function(e){var t=e.photos,n=e.setFiles,o=e.texts,c=N().ticketStore,a=c.isTicketCreatorOrAdmin,s=c.selectedTicket,u=c.deletePhoto,l=c.deleteTextFile,d=c.isDeletingPhoto,p=c.isDeletingText,j=c.setTicketFiles,h=Object(i.useState)(""),g=Object(H.a)(h,2),x=g[0],O=g[1],v=Object(i.useState)(!1),k=Object(H.a)(v,2),y=k[0],w=k[1],C=t||o,T=function(e,t){return e.length>0&&Object(r.jsx)(B.a.Row,{fluid:"true",columns:e.length,children:null===e||void 0===e?void 0:e.map((function(e,n){return Object(r.jsx)(B.a.Column,{fluid:"true",children:Object(r.jsxs)(b.a,{compact:!0,style:{position:"relative"},children:[!t&&Object(r.jsxs)("div",{style:{margin:"auto"},children:[Object(r.jsx)(q.a,{src:e.url?e.url:e.preview,id:n,width:"200px",height:"200px",style:{cursor:"pointer"},onClick:function(){e.id=e.id?e.id:n.toString(),O(e.id),w(!0)}}),Object(r.jsx)("p",{style:{textAlign:"center",color:"black"},children:e.name}),Object(r.jsx)(Ot,{img:e,isOpen:y,id:x,setIsModalOpen:w,isPhoto:!0})]}),t&&Object(r.jsxs)("div",{style:{margin:"auto"},children:[Object(r.jsx)(J.a,{name:"file outline",size:"massive",style:{marginLeft:"2px",cursor:"pointer"},onClick:function(){e.id=e.id?e.id:n.toString(),w(!0),O(e.id)}}),Object(r.jsx)("p",{style:{textAlign:"center",color:"black"},children:e.name}),Object(r.jsx)(Ot,{img:e,isOpen:y,id:x,setIsModalOpen:w,isPhoto:!1})]}),a&&Object(r.jsx)(je.a,{header:"Delete this attachement.",trigger:Object(r.jsx)(_.a,{style:{position:"absolute",top:"0",left:"0",right:"0",border:"1px solid black"},negative:!0,icon:"remove",size:"mini",loading:(d||p)&&x===e.id,onClick:function(){console.log("IMG ID: ",e.id),O(e.id?e.id:e.id=n.toString()),S(t,e)}})})]})},n)}))})},S=function(){var e=Object(m.a)(f.a.mark((function e(t,r){var i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.id.length>2)){e.next=10;break}if(t){e.next=6;break}return e.next=4,u(s.id,r.id);case 4:e.next=8;break;case 6:return e.next=8,l(s.id,r.id);case 8:e.next=14;break;case 10:for(i=new Array(C.length-1),o=0;o<(null===C||void 0===C?void 0:C.length);o++)o===parseInt(r.id)||C[o]&&(i[o]=C[o]);n(i),j(i);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)(B.a,{style:{paddingTop:"10px"},children:[t&&T(t,!1),o&&T(o,!0)]})})})),kt=5e5,yt=["image/jpeg","image/png","image/jpg"],wt=["text/plain","image/txt"],Ct=Object(d.a)((function(e){var t=e.isPreview,n=e.isPhoto,o=N().ticketStore,c=o.isAddingPhoto,a=o.setTicketFiles,s=Object(i.useState)([]),u=Object(H.a)(s,2),l=u[0],d=u[1],j=Object(i.useState)(!1),b=Object(H.a)(j,2),h=b[0],f=b[1],m=Object(i.useState)(!1),g=Object(H.a)(m,2),x=g[0],O=g[1];return Object(r.jsxs)(p.a,{style:{marginBottom:"10px"},fluid:!0,children:[Object(r.jsx)(De,{setFiles:function(e){var t=!1,r=!1,i=0;e.forEach((function(e){return i+=e.size,(n?yt.includes(e.type):wt.includes(e.type))?e.size>(n?kt:5e4)?(t=!0,void d([])):void 0:(console.log("Textfile: ",e),r=!0,d([]),void O(!0))})),i>kt&&(t=!0,d([])),t||r?(r&&O(!0),t&&f(!0)):(d(e),a(e))},isTicket:!0,children:Object(r.jsxs)(_.a,{type:"button",size:"tiny",style:{border:"1px black dashed",marginTop:"10px"},onClick:function(){f(!1),O(!1)},fluid:!0,children:[n?"Add photo":"Add text",Object(r.jsx)(J.a,{name:"upload",size:"large",style:{marginLeft:"2px"}})]})}),h&&Object(r.jsx)(gt,{status:!0,header:"Sorry your image is too big",message:"Compress the image and try again. Size > ".concat(kt," kb.")}),x&&Object(r.jsx)(gt,{status:!0,header:"Sorry that filetype is not accepted",message:"Change filetype to image/jpg or image/png."}),l.length>0&&!h&&n&&!x&&Object(r.jsx)(vt,{photos:l,setFiles:d}),l.length>0&&!h&&!n&&!x&&Object(r.jsx)(vt,{texts:l,setFiles:d}),t&&l.length>0&&!h&&!x&&Object(r.jsx)(_.a,{style:{marginTop:"10px"},positive:!0,content:"submit",loading:c,onClick:function(){d([])}})]})})),Tt=function(e){return e?void 0:"Required"},St=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.reduce((function(t,n){return t||n(e)}),void 0)}},Pt=[{key:"Low",value:"low",text:"Low"},{key:"Medium",value:"medium",text:"Medium"},{key:"High",value:"high",text:"High"}],At=[{key:"Open",value:"open",text:"Open"},{key:"Verify",value:"verify",text:"Ready for verification"},{key:"Closed",value:"closed",text:"Closed"}],Gt={size:"8px",color:"grey",marginBottom:"2px"},It=Object(d.a)((function(e){var t=e.ticket,n=e.setIsEditingTicket,o=N(),c=o.ticketStore,a=o.groupStore,s=c.createTicket,u=c.editTicket,l=c.createWithPhoto,d=c.submittingTicket,p=c.ticketFiles,j=a.groupTitleForUserOptions,h=a.groupTitles,g=a.loadGroups,x=a.loadingGroups,O=null!==t&&void 0!==t?t:new ht,v=Object(i.useState)([]),k=Object(H.a)(v,2),y=k[0];k[1];Object(i.useEffect)((function(){function e(){return(e=Object(m.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(h.length<=0)){e.next=3;break}return e.next=3,g();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){y.forEach((function(e){return URL.revokeObjectURL(e.preview)}))}}),[g,h,y]);var w=function(){var e=Object(m.a)(f.a.mark((function e(t){var r,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(new Date).toISOString(),0!==O.id.length){e.next=6;break}i=Object(Q.a)(Object(Q.a)({},t),{},{date:r,id:Object(K.a)()}),p.length>0?l(i):s(i),e.next=10;break;case 6:return console.log("Editing ticket: ",t),e.next=9,u(t);case 9:!d&&n&&n(!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return x?Object(r.jsx)(de,{content:"Preparing data..."}):Object(r.jsx)(b.a,{fluid:"true",children:Object(r.jsx)($.b,{initialValues:O,onSubmit:w,render:function(e){var t,i=e.handleSubmit,o=e.invalid,a=e.pristine;return Object(r.jsxs)(X.a,{onSubmit:i,children:[Object(r.jsx)("p",{style:Gt,children:"Group"}),Object(r.jsx)($.a,{validate:Tt,name:"groupId",placeholder:"Group",options:j,value:O.groupId,component:mt}),Object(r.jsx)("p",{style:Gt,children:"Title"}),Object(r.jsx)($.a,{validate:Tt,name:"title",placeholder:"Title",value:O.title,component:te}),Object(r.jsx)("p",{style:Gt,children:"Version"}),Object(r.jsx)($.a,{validate:Tt,component:te,placeholder:"Version",name:"version",value:O.version}),Object(r.jsx)("p",{style:Gt,children:"Priority"}),Object(r.jsx)($.a,{validate:Tt,component:mt,placeholder:"Priority",name:"priority",value:O.priority,options:Pt}),Object(r.jsx)("p",{style:Gt,children:"Device"}),Object(r.jsx)($.a,{validate:Tt,component:te,placeholder:"Device",name:"device",value:O.device}),Object(r.jsx)("p",{style:Gt,children:"Bug type"}),Object(r.jsx)($.a,{validate:Tt,component:te,placeholder:"Bug type",name:"bugType",value:O.bugType}),Object(r.jsx)("p",{style:Gt,children:"Status"}),Object(r.jsx)($.a,{validate:Tt,component:mt,placeholder:"Status",name:"status",value:O.status,options:At}),Object(r.jsx)("p",{style:Gt,children:"Description"}),Object(r.jsx)($.a,{validate:St(Tt,(t=15,function(e){return e.length>t||e>=t?void 0:"Should be atleast ".concat(t," characters long.")})),component:ne,rows:2,name:"description",placeholder:"Description",value:O.description}),!n&&Object(r.jsx)(Ct,{isPreview:!1,isPhoto:!0}),!n&&Object(r.jsx)(Ct,{isPreview:!1,isPhoto:!1}),Object(r.jsx)(_.a,{disabled:c.submittingTicket||o||a,loading:c.submittingTicket,type:"submit",positive:!0,children:"Submit Ticket"})]})}})})})),Ft=function(e){return e?void 0:"Required"},Rt=function(e){var t=e.addComment,n=e.isAddingComment,o=e.ticket,c=(e.profile,e.user),a=Object(i.useState)(!1),s=Object(H.a)(a,2),u=s[0],l=s[1];return Object(r.jsx)("div",{style:{margin:"auto",paddingTop:"10px"},children:u?Object(r.jsx)($.b,{onSubmit:function(e){return t(o,{body:e.body,username:c.username,displayName:c.displayName,createdAt:new Date,image:c.image})},render:function(e){var t=e.handleSubmit,i=e.submitting,o=e.form,c=e.invalid,a=e.pristine;return Object(r.jsxs)(X.a,{onSubmit:function(){return t().then((function(){l(!1),o.reset()}))},children:[Object(r.jsx)($.a,{name:"body",validate:Ft,component:ne,rows:2,placeholder:"Add Comment"}),Object(r.jsx)(_.a,{disabled:n||c||a,content:"Add Reply",labelPosition:"left",icon:"edit",primary:!0,loading:i||n}),Object(r.jsx)(_.a,{content:"Cancel",labelPosition:"right",icon:"cancel",type:"button",onClick:function(){return l(!1)}})]})}}):Object(r.jsx)(_.a,{labelPosition:"right",icon:"add",content:"Comment",positive:!0,inverted:!0,onClick:function(){return l(!0)}})})},Et=n(281),Dt=function(e){return e?void 0:"Required"},Lt=function(e){var t=e.ticketId,n=e.commentId,i=e.commentBody,o=e.setIsEditComment,c=e.editComment,a=e.isEditingComment,s=function(){var e=Object(m.a)(f.a.mark((function e(r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c(t,n,r);case 3:o(!1),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsx)("div",{style:{marginTop:"4px"},children:Object(r.jsx)($.b,{initialValues:{body:i},onSubmit:s,render:function(e){var t=e.handleSubmit,n=e.invalid,c=e.pristine;return Object(r.jsxs)(X.a,{onSubmit:t,children:[Object(r.jsx)($.a,{placeholder:"body",validate:Dt,value:i,name:"body",rows:3,component:ne}),Object(r.jsx)(_.a,{disabled:a||n||c,loading:a,floated:"right",positive:!0,type:"submit",content:"submit"}),Object(r.jsx)(_.a,{floated:"right",type:"button",content:"cancel",onClick:function(){return o(!1)}})]})}})})},Mt=Object(d.a)((function(e){var t=e.comments,n=e.editComment,o=e.deleteComment,c=e.isEditingComment,a=e.isDeletingComment,s=e.user,u=e.ticketId,l=Object(i.useState)(!1),d=Object(H.a)(l,2),j=d[0],h=d[1],f=Object(i.useState)(""),m=Object(H.a)(f,2),g=m[0],x=m[1];return t&&t.length>0?null===t||void 0===t?void 0:t.map((function(e,t){return Object(r.jsx)(B.a,{style:{border:"1px solid black",background:"#f2f2f2",marginBottom:"1px"},children:Object(r.jsxs)(B.a.Row,{children:[Object(r.jsx)(B.a.Column,{width:2,children:Object(r.jsx)(W.a.Group,{children:Object(r.jsx)(W.a,{style:{border:"1px solid black"},children:Object(r.jsxs)(p.a,{style:{justifyContent:"center",margin:"auto",padding:"4px"},children:[Object(r.jsx)(W.a.Image,{src:e.image||"/assets/user.png",size:"tiny",style:{width:"auto"}}),Object(r.jsx)(W.a.Extra,{as:Ce.a,to:"/profile/".concat(e.username),style:{textAlign:"center"},children:e.displayName}),Object(r.jsx)(W.a.Meta,{children:Object(r.jsxs)("div",{style:{textAlign:"center"},children:["Member for: ",Object(r.jsx)("br",{}),Object(Et.a)(new Date(s.dateJoined),new Date)]})})]})})})}),Object(r.jsx)(B.a.Column,{width:14,children:Object(r.jsx)("div",{style:{padding:"4px"},children:Object(r.jsxs)(Oe.a,{children:[Object(r.jsx)(Oe.a.Metadata,{children:Object(r.jsx)(B.a,{children:Object(r.jsxs)(B.a.Row,{columns:"2",children:[Object(r.jsxs)(B.a.Column,{floated:"left",children:["Posted"," ",Object(me.a)(new Date(e.createdAt),new Date)," ","ago."]}),Object(r.jsx)(B.a.Column,{textAlign:"right",floated:"right",children:(null===s||void 0===s?void 0:s.username)===e.username&&Object(r.jsxs)(B.a.Row,{children:[Object(r.jsx)(_.a,{content:"Edit",icon:"edit",primary:!0,onClick:function(){x(e.id),h(!0)}}),Object(r.jsx)(_.a,{loading:a&&e.id===g,content:"Delete",icon:"cancel",negative:!0,onClick:function(){x(e.id),o(u,e.id)}})]})})]})})}),j&&g===e.id?Object(r.jsx)(Lt,{ticketId:u,commentId:e.id,commentBody:e.body,setIsEditComment:h,editComment:n,isEditingComment:c},e.id):Object(r.jsx)(Oe.a.Text,{style:{paddingTop:"4px"},children:e.body})]})})})]})},e.id)})):Object(r.jsx)(B.a,{centered:!0,style:{marginBottom:"4px"},children:Object(r.jsxs)(b.a,{placeholder:!0,size:"large",compact:!0,style:{minHeight:"4px"},children:[Object(r.jsx)(J.a,{name:"comment"}),"This ticket has no comments yet. Feel free to add one!"]})})})),Nt=Object(d.a)((function(e){var t=e.photos,n=e.setFiles,o=e.setFilesForForm,c=e.texts,a=N().ticketStore,s=a.isTicketCreatorOrAdmin,u=a.selectedTicket,l=a.deletePhoto,d=a.deleteTextFile,p=a.isDeletingPhoto,j=a.isDeletingText,h=Object(i.useState)(""),g=Object(H.a)(h,2),x=g[0],O=g[1],v=Object(i.useState)(!1),k=Object(H.a)(v,2),y=k[0],w=k[1],C=function(e,t){return e.length>0&&Object(r.jsx)(B.a.Row,{fluid:"true",columns:e.length,children:null===e||void 0===e?void 0:e.map((function(e,n){return Object(r.jsx)(B.a.Column,{fluid:"true",children:Object(r.jsxs)(b.a,{compact:!0,style:{position:"relative"},children:[!t&&Object(r.jsxs)("div",{style:{margin:"auto"},children:[Object(r.jsx)(q.a,{src:e.url?e.url:e.preview,id:n,width:"200px",height:"200px",style:{cursor:"pointer"},onClick:function(){w(!0),O(e.id)}}),Object(r.jsx)("p",{style:{textAlign:"center",color:"black"},children:e.name})]}),t&&Object(r.jsxs)("div",{style:{margin:"auto"},children:[Object(r.jsx)(J.a,{name:"file outline",size:"massive",style:{marginLeft:"2px",cursor:"pointer"},onClick:function(){w(!0),O(e.id)}}),Object(r.jsx)("p",{style:{textAlign:"center",color:"black"},children:e.name}),Object(r.jsx)(Ot,{img:e,isOpen:y,id:x,setIsModalOpen:w,isPhoto:!1})]}),s&&Object(r.jsx)(je.a,{header:"Delete this attachement.",trigger:Object(r.jsx)(_.a,{style:{position:"absolute",top:"0",left:"0",right:"0",border:"1px solid black"},negative:!0,icon:"remove",size:"mini",loading:(p||j)&&x===e.id,onClick:function(){O(e.id),T(t,e)}})}),!t&&Object(r.jsx)(Ot,{img:e,isOpen:y,id:x,setIsModalOpen:w,isPhoto:!0})]})},n)}))})},T=function(){var e=Object(m.a)(f.a.mark((function e(t,r){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.id){e.next=10;break}if(t){e.next=6;break}return e.next=4,l(u.id,r.id);case 4:e.next=8;break;case 6:return e.next=8,d(u.id,r.id);case 8:e.next=12;break;case 10:n([]),o&&o([]);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(r.jsx)(r.Fragment,{children:Object(r.jsxs)(B.a,{style:{paddingTop:"10px"},children:[t&&C(t,!1),c&&C(c,!0)]})})})),Ut=function(e){var t=e.LIMIT_FILESIZE,n=e.LIMIT_FILETYPE,o=e.toobig_message,c=e.badfile_message,a=e.ticketId,s=e.buttonText,u=e.isAddingItem,l=e.isPreview,d=e.addFile,p=e.setFilesForForm,j=Object(i.useState)([]),b=Object(H.a)(j,2),h=b[0],g=b[1],x=Object(i.useState)(!1),O=Object(H.a)(x,2),v=O[0],k=O[1],y=Object(i.useState)(!1),w=Object(H.a)(y,2),C=w[0],T=w[1],S=Object(i.useState)(!1),P=Object(H.a)(S,2),A=P[0],G=P[1];return Object(r.jsxs)("div",{style:{marginBottom:"10px"},children:[Object(r.jsx)(De,{setFiles:function(e){var r=!1,i=!1;if(e.length>1)return G(!0),g([]),void(p&&p([]));e.forEach((function(e){if(e.size>t)return r=!0,g([]),void(p&&p([]));n.includes(e.type)||(i=!0,g([]),p&&p([]),T(!0))})),r||i?(i&&T(!0),r&&k(!0)):(g(e),p&&p(e))},isTicket:!0,children:Object(r.jsx)(_.a,{type:"button",size:"tiny",style:{border:"2px rgba(255,255,255, 0.6) dashed",marginTop:"10px",color:"white",backgroundColor:"#bc4123"},fluid:!0,onClick:function(){G(!1),k(!1),T(!1)},children:Object(r.jsxs)("div",{children:[s,Object(r.jsx)(J.a,{name:"upload",size:"large",style:{marginLeft:"2px"}})]})})}),A&&Object(r.jsx)(gt,{status:!0,header:"Too many files.",message:"Upload one file at a time."}),v&&Object(r.jsx)(gt,{status:!0,header:o[0],message:o[1]}),C&&Object(r.jsx)(gt,{status:!0,header:"Sorry, that filetype is not accepted.",message:c}),h.length>0&&!v&&!C&&("Add TextFile"!==s?Object(r.jsx)(Nt,{photos:h,setFiles:g,setFilesForForm:p}):Object(r.jsx)(Nt,{texts:h,setFiles:g,setFilesForForm:p})),l&&h.length>0&&!v&&!C&&Object(r.jsx)(_.a,{style:{marginTop:"10px"},positive:!0,content:"submit",loading:u,onClick:Object(m.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=d,e.t1=a,e.next=4,E(h);case 4:return e.t2=e.sent,e.next=7,(0,e.t0)(e.t1,e.t2);case 7:g([]);case 8:case"end":return e.stop()}}),e)})))})]})},Ht=["text/plain"],Bt=5e5,zt=["image/jpeg","image/png","image/jpg"],_t=function(e){var t=e.ticket;return Object(r.jsx)(pe.a,{children:Object.entries(t).map((function(e,t){var n,i=Object(H.a)(e,2),o=i[0],c=i[1];return["status","version","priority","bugType","device"].includes(o)&&Object(r.jsx)(pe.a.Item,{children:Object(r.jsxs)("p",{children:[Object(r.jsx)("b",{children:(n=o,n.charAt(0).toUpperCase()+n.slice(1))}),": ",c]})},t)}))})},Vt=Object(d.a)((function(e){var t=e.ticket,n=(e.isTicketCreatorOrAdmin,e.addTextFile),o=e.addPhoto,c=e.isAddingPhoto,a=e.isAddingText,s=Object(i.useState)([!0,!0,!0]),u=Object(H.a)(s,2),l=u[0],d=u[1],p=function(e,t){0===t.index?d([!l[0],l[1],l[2]]):1===t.index?d([l[0],!l[1],l[2]]):d([l[0],l[1],!l[2]])};return Object(r.jsx)(B.a,{children:Object(r.jsxs)(B.a.Column,{width:16,children:[Object(r.jsxs)(ge.a,{exclusive:!1,fluid:!0,children:[Object(r.jsx)(ge.a.Title,{active:!0===l[0],index:0,onClick:p,children:Object(r.jsxs)("p",{children:[Object(r.jsx)(J.a,{name:"dropdown"}),"Details"]})}),Object(r.jsx)(ge.a.Content,{active:!0===l[0],children:Object(r.jsx)(_t,{ticket:t})}),Object(r.jsx)(ge.a.Title,{active:!0===l[1],index:1,onClick:p,children:Object(r.jsxs)("p",{children:[Object(r.jsx)(J.a,{name:"dropdown"}),"Description"]})}),Object(r.jsx)(ge.a.Content,{active:!0===l[1],children:Object(r.jsx)(pe.a,{children:Object(r.jsx)(pe.a.Item,{children:Object(r.jsx)("p",{children:t.description})})})}),(t.photos.length||t.texts.length)>0&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ge.a.Title,{active:!0===l[2],index:2,onClick:p,children:Object(r.jsxs)("p",{children:[Object(r.jsx)(J.a,{name:"dropdown"}),"Attachements"]})}),Object(r.jsx)(ge.a.Content,{active:!0===l[2],children:Object(r.jsx)(Nt,{photos:t.photos,texts:t.texts})})]})]}),Object(r.jsx)(Ut,{isPreview:!0,LIMIT_FILESIZE:Bt,LIMIT_FILETYPE:zt,ticketId:t.id,buttonText:"Add Photo",isAddingItem:c,addFile:o,toobig_message:["Sorry that file is too big.","Maximum size is ".concat(Bt," kb.")],badfile_message:"Change filetype to image/jpeg or image/png."}),Object(r.jsx)(Ut,{isPreview:!0,LIMIT_FILESIZE:1e4,LIMIT_FILETYPE:Ht,ticketId:t.id,buttonText:"Add TextFile",isAddingItem:a,addFile:n,toobig_message:["Sorry that file is too big.","Maximum size of a .txt is 10kb"],badfile_message:"Change filetype to text/plain or .txt"})]})})})),qt=Object(d.a)((function(e){var t=e.match,n=N(),o=n.profileStore,c=n.ticketStore,a=n.userStore,s=o.loadProfile,u=o.loadingProfile,d=o.profile,h=a.user,g=c.isAddingComment,x=c.addComment,O=c.deleteComment,v=c.editComment,k=c.editTicketStatus,y=c.submittingTicket,w=c.setSelectedTicketFromId,C=c.isEditingComment,T=c.selectedTicket,S=c.isDeletingComment,P=c.isTicketCreatorOrAdmin,A=c.addTextFile,G=c.addPhoto,I=c.isAddingText,F=c.isAddingPhoto,R=Object(i.useState)(""),E=Object(H.a)(R,2),D=E[0],L=E[1],M=Object(i.useState)(!1),U=Object(H.a)(M,2),B=U[0],z=U[1];Object(i.useEffect)((function(){null===T&&t.params.id&&w(t.params.id),(null===d&&T||T&&d.username!==T.creator&&null!==T)&&s(T.creator)}),[s,d,t.params,T,w]);var Y=function(){var e=Object(m.a)(f.a.mark((function e(t){var n,r,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null===(n=t.value)||void 0===n?void 0:n.toLowerCase(),i=t.style.color,o=Object(l.i)(T),"closed"!==r&&"red"!==i||(o.status="closed"),"verify"!==r&&"green"!==i||(o.status="verify"),"open"!==r&&"blue"!==i||(o.status="open"),L(o.status),e.next=9,k(o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(u)return Object(r.jsx)(de,{content:"Loading profile tickets..."});var W=Object(l.i)(T.status).toLowerCase(),J=P();return Object(r.jsx)(p.a,{children:Object(r.jsxs)(b.a,{clearing:!0,children:[Object(r.jsx)(pe.a,{divided:!0,relaxed:!0,children:T.id===t.params.id&&Object(r.jsxs)(pe.a.Item,{children:[Object(r.jsxs)(pe.a.Content,{children:[Object(r.jsxs)(pe.a.Header,{style:{color:"white"},children:[Object(r.jsx)(q.a,{avatar:!0,src:(null===d||void 0===d?void 0:d.image)||"/assets/user.png"}),T.title]}),Object(r.jsxs)(pe.a.Description,{style:{marginLeft:"32px",color:"white"},children:[Object(l.i)(T.date).replace("T"," "),Object(r.jsxs)(_.a.Group,{size:"mini",floated:"right",onClick:function(e){Y(e.target)},children:[Object(r.jsx)(_.a,{basic:!0,color:"red",value:"Closed",loading:y&&"closed"===D,children:Object(r.jsx)(ct,{isFilled:"closed"===W,status:"closed"})}),Object(r.jsx)(_.a,{basic:!0,color:"green",value:"Verify",loading:y&&"verify"===D,children:Object(r.jsx)(ct,{isFilled:"verify"===W,status:"verify"})}),Object(r.jsx)(_.a,{basic:!0,color:"blue",value:"Open",loading:y&&"open"===D,children:Object(r.jsx)(ct,{isFilled:"open"===W,status:"open"})})]}),J&&Object(r.jsxs)(rt.a,{onClose:function(){return z(!1)},onOpen:function(){return z(!0)},open:B,trigger:Object(r.jsx)(_.a,{floated:"right",style:{marginRight:"80px",color:"white",backgroundColor:"#bc4123"},size:"large",content:"Edit Ticket",onClick:function(){return z(!0)}}),children:[Object(r.jsx)(rt.a.Content,{children:Object(r.jsx)(It,{ticket:T,setIsEditingTicket:z})}),Object(r.jsx)(rt.a.Actions,{children:Object(r.jsx)(_.a,{content:"close",icon:"cancel",onClick:function(){return z(!1)}})})]})]})]}),Object(r.jsx)(Vt,{ticket:T,isTicketCreatorOrAdmin:J,addTextFile:A,addPhoto:G,isAddingText:I,isAddingPhoto:F})]},T.id)}),Object(r.jsx)(V.a,{}),(null===T||void 0===T?void 0:T.id)===t.params.id&&Object(r.jsxs)("div",{style:{marginLeft:"14px",marginRight:"14px"},children:[Object(r.jsx)(j.a,{style:{textAlign:"center",color:"white"},children:"Comments"}),Object(r.jsx)(Mt,{comments:T.comments,deleteComment:O,editComment:v,user:h,ticketId:T.id,isEditingComment:C,isDeletingComment:S},T.id)]},T.id),Object(r.jsx)(Rt,{ticket:T,isAddingComment:g,addComment:x,user:h})]})})})),Yt=n(294),Wt=Object(d.a)((function(e){var t=e.groupId,n=N().groupStore.getGroups,i={open:0,verify:0,closed:0};if(t){var o=n.filter((function(e){return e.id===t}));i.open=o[0].open,i.closed=o[0].closed,i.verify=o[0].verify}return Object(r.jsxs)(Yt.a.Group,{widths:3,children:[Object(r.jsxs)(Yt.a,{color:"blue",size:"mini",children:[Object(r.jsx)(Yt.a.Value,{text:!0,style:{minHeight:"0em"},children:i.open}),Object(r.jsx)(Yt.a.Label,{style:{color:"white"},children:"Open"})]}),Object(r.jsxs)(Yt.a,{color:"green",size:"mini",children:[Object(r.jsx)(Yt.a.Value,{text:!0,style:{minHeight:"0em"},children:i.verify}),Object(r.jsx)(Yt.a.Label,{style:{color:"white"},children:"Verify"})]}),Object(r.jsxs)(Yt.a,{color:"red",size:"mini",children:[Object(r.jsx)(Yt.a.Value,{text:!0,style:{minHeight:"0em"},children:i.closed}),Object(r.jsx)(Yt.a.Label,{style:{color:"white"},children:"Closed"})]})]})})),Jt=n(283),Zt={loading:!1,results:[],value:""};function Qt(e,t){switch(t.type){case"CLEAN_QUERY":return Zt;case"START_SEARCH":return Object(Q.a)(Object(Q.a)({},e),{},{loading:!0,value:t.query});case"FINISH_SEARCH":return Object(Q.a)(Object(Q.a)({},e),{},{loading:!1});case"UPDATE_SELECTION":return Object(Q.a)(Object(Q.a)({},e),{},{value:t.selection});default:throw new Error}}var Xt=function(e){var t=e.titleList,n=e.handleSearchResults,i=o.a.useReducer(Qt,Zt),c=Object(H.a)(i,2),a=c[0],s=c[1],u=a.loading,l=a.value,d=o.a.useCallback((function(e,r){if(s({type:"START_SEARCH",query:r.value}),0===r.value.length)return s({type:"CLEAN_QUERY"}),void n([]);var i=new RegExp(r.value,"i"),o=t.filter((function(e){return t=e,i.test(t.title);var t})).map((function(e){return e.id}));s({type:"FINISH_SEARCH"}),n(o)}),[t,n]);return Object(r.jsx)(B.a,{children:Object(r.jsx)(B.a.Column,{width:6,children:Object(r.jsx)(Jt.a,{disabled:0===t.length,placeholder:"Search title...",loading:u,onSearchChange:d,value:l,showNoResults:!1})})})},Kt=[{key:"open",text:"Open",value:"open",icon:{color:"blue",name:"circle"}},{key:"verify",text:"Ready for verification",value:"verify",icon:{color:"green",name:"circle"}},{key:"closed",text:"Closed",value:"closed",icon:{color:"red",name:"circle"}}],$t=Object(d.a)((function(){var e=N(),t=e.ticketStore,n=e.groupStore,o=t.setSelectedTicket,c=Object(i.useState)(""),a=Object(H.a)(c,2),s=a[0],u=a[1],l=Object(i.useState)(""),d=Object(H.a)(l,2),p=d[0],h=d[1],g=Object(i.useState)([]),x=Object(H.a)(g,2),O=x[0],v=x[1];Object(i.useEffect)((function(){t.loadTickets(),n.loadGroups()}),[t,n,h]);var k=function(e,t){if(t&&e){var r=n.groupRegistry.get(e).members.filter((function(e){return e.username===t}));if(r&&r[0])return r[0].image}return"/assets/user.png"},y=function(e,t){if(""!==t.value){var n=t.value.toLowerCase();"Filter By Group"===t.placeholder?(h(n),u("")):u(n)}};return t.loadingTickets?Object(r.jsx)(de,{content:"Loading Tickets..."}):Object(r.jsxs)(b.a,{clearing:!0,children:[Object(r.jsx)(j.a,{textAlign:"center",style:{color:"white"},children:"Issues"}),Object(r.jsx)(B.a,{columns:4,divided:!0,stackable:!0,children:Object(r.jsxs)(B.a.Row,{children:[Object(r.jsx)(B.a.Column,{children:Object(r.jsx)(z.a,{placeholder:"Filter By Group",fluid:!0,selection:!0,options:n.groupTitleForUser,onChange:y})}),Object(r.jsx)(B.a.Column,{children:Object(r.jsx)(z.a,{disabled:""===p||""!==p&&n.groupRegistry.get(p).tickets.length<=0,placeholder:"Filter By Ticket Status",fluid:!0,value:s,selection:!0,options:Kt,onChange:y})}),Object(r.jsx)(B.a.Column,{children:Object(r.jsx)(Wt,{groupId:p})}),Object(r.jsx)(B.a.Column,{children:Object(r.jsx)(Xt,{titleList:t.ticketsByDate.filter((function(e){return e.status.toLowerCase()===s&&e})),handleSearchResults:function(e){v(e)}})})]})}),Object(r.jsx)(V.a,{}),Object(r.jsx)(pe.a,{divided:!0,relaxed:!0,children:t.ticketsByDate.map((function(e){return e.status.toLowerCase()===s&&e.groupId===p&&(function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1}(O,e.id)||0===O.length)&&Object(r.jsxs)(pe.a.Item,{children:[Object(r.jsx)(q.a,{avatar:!0,src:k(p,e.creator)}),Object(r.jsxs)(pe.a.Content,{children:[Object(r.jsx)(pe.a.Header,{as:Ce.a,to:"/ticket/".concat(e.groupId,"/").concat(e.id),onClick:Object(m.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o(e);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),children:e.title}),Object(r.jsx)(pe.a.Description,{style:{color:"white"},children:e.date.replace("T"," ")})]})]},e.id)}))})]})})),en=function(){return Object(r.jsxs)(b.a,{placeholder:!0,children:[Object(r.jsxs)(j.a,{icon:!0,children:[Object(r.jsx)(J.a,{name:"search"}),"Oops - we've looked everywhere but couldn't find this."]}),Object(r.jsx)(b.a.Inline,{children:Object(r.jsx)(_.a,{as:Ce.a,to:"/issues",primary:!0,children:"Return to Tickets page"})})]})},tn=n(204),nn=Object(d.a)((function(e){var t=e.component,n=Object(tn.a)(e,["component"]),i=N().userStore.isLoggedIn;return Object(r.jsx)(u.b,Object(Q.a)(Object(Q.a)({},n),{},{render:function(e){return i?Object(r.jsx)(t,Object(Q.a)({},e)):Object(r.jsx)(u.a,{to:"/"})}}))})),rn=Object(u.i)(Object(d.a)((function(e){e.location;var t=N(),n=t.commonStore,o=t.userStore,c=n.setAppLoaded,a=n.token,s=n.appLoaded,d=o.getUser;return Object(i.useEffect)((function(){Object(l.b)((function(){a&&!s?d().finally((function(){return c()})):s||c()}))}),[]),s?Object(r.jsxs)(i.Fragment,{children:[Object(r.jsx)(u.b,{exact:!0,path:"/",component:Xe}),Object(r.jsx)(u.b,{path:"/(.+)",render:function(){return Object(r.jsxs)(i.Fragment,{children:[Object(r.jsx)($e,{}),Object(r.jsx)(p.a,{style:{marginTop:"7em"},children:Object(r.jsxs)(u.d,{children:[Object(r.jsx)(nn,{path:"/issues",component:$t}),Object(r.jsx)(nn,{path:"/ticket/:username/:id",component:qt}),Object(r.jsx)(nn,{path:"/ticket/:groupId/:id",component:qt}),Object(r.jsx)(nn,{path:"/groups",component:Be}),Object(r.jsx)(nn,{path:"/createTicket",component:It}),Object(r.jsx)(nn,{path:"/profile/:username",component:bt}),Object(r.jsx)(u.b,{path:"/server-error",component:U}),Object(r.jsx)(u.b,{component:en})]})})]})}})]}):Object(r.jsx)(de,{content:"Loading app..."})}))),on=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,302)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),i(e),o(e),c(e)}))},cn=(n(255),n(200));function an(){var e=Object(u.h)().pathname;return Object(i.useEffect)((function(){window.scrollTo(0,0)}),[e]),null}new(n.n(cn).a);var sn=Object(s.a)();a.a.render(Object(r.jsx)(M.Provider,{value:L,children:Object(r.jsxs)(u.c,{history:sn,children:[Object(r.jsx)(an,{}),Object(r.jsx)(rn,{})]})}),document.getElementById("root")),on()}},[[259,1,2]]]);
//# sourceMappingURL=main.6e8254f1.chunk.js.map